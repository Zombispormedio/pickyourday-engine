function saveLocal(n,t){localStorage[n]=JSON.stringify(t)}function getJSONLocal(n){var t=null;try{var e=localStorage[n];void 0!==e&&(t=JSON.parse(e))}catch(o){}return t}function deleteLocal(n){localStorage.removeItem(n)}function ClosureMessage(n){return function(t){return function(){t(n)}}}function emptyOrUndefined(n){return void 0==n||""===n}function RandPosition(n){var t=n||{min:0,max:100},e=chance.floating(t),o=chance.floating(t),r=chance.floating(t);return[e,o,r]}function RandColor(n){var t=n||{min:0,max:1,fixed:2},e=chance.floating(t),o=chance.floating(t),r=chance.floating(t);return[e,o,r,1]}function RandSize(n){var t=n||{min:.1,max:2,fixed:1},e=chance.floating(t);return[e,e,e]}function RandRotation(n){var t=Number(chance.bool()),e=Number(chance.bool()),o=Number(chance.bool());return{angle:chance.integer({min:0,max:360}),axis:[t,e,o]}}function generate(n){return function(){var t=chance.integer({min:0,max:100});return Array.apply(0,Array(t)).map(n)}}var app=angular.module("Application",["ui.router","ngResource","ngAnimate","ngMaterial"]);!function(n){try{n=angular.module("Application")}catch(t){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/main.html",'\n<md-toolbar class="md-accent md-whiteframe-1dp">\n    <div class="md-toolbar-tools">\n\n\n        <md-menu flex="5">\n            <md-button aria-label="Type Stats" class="md-icon-button" ng-click="openMenu($mdOpenMenu, $event)">\n                <md-icon md-menu-origin md-font-icon="mdi-chart-areaspline" class="mdi"></md-icon>\n            </md-button>\n            <md-menu-content width="4">\n                <md-menu-item>\n                    <md-button ui-sref="app.normal">\n                        <md-icon md-font-icon="mdi-chart-bubble" class="mdi"></md-icon>\n                        Normal\n                    </md-button>\n                </md-menu-item>\n                <md-menu-item>\n                    <md-button  ui-sref="app.slider">\n                        <md-icon md-font-icon="mdi-clock-start" class="mdi"></md-icon>\n                        Slider\n                    </md-button>\n                </md-menu-item>\n                <md-menu-divider></md-menu-divider>\n                <md-menu-item>\n                    <md-button  ui-sref="app.player">\n                        <md-icon md-font-icon="mdi-play-box-outline" class="mdi"></md-icon>\n                        Player\n                    </md-button>\n                </md-menu-item>\n            </md-menu-content>\n        </md-menu>\n\n        <h2>\n            <span>Pickyourday 3D</span>\n        </h2>\n        <span flex></span>\n        <md-button aria-label="logout" class="md-icon-button" style="margin-right: 0px;" ng-click="logout()">\n            <md-icon md-font-icon="mdi-power" class="mdi"></md-icon>\n        </md-button>\n    </div>\n</md-toolbar>\n\n\n<div ui-view="content"></div>')}])}(),function(n){try{n=angular.module("Application")}catch(t){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/login/main.html",'<div layout="column" layout-align="center center">\n\n\n\n    <md-card>\n        <md-card-title>\n            <md-card-title-text>\n                <span class="md-headline">Pickyourday 3D</span>\n\n            </md-card-title-text>\n\n        </md-card-title>\n        <md-card-content layout="column">\n\n\n            <md-input-container class="md-primary md-raised md-hue-2">\n                <label>Email</label>\n                <input ng-model="user.email" type="email">\n            </md-input-container>\n\n            <md-input-container class="md-primary md-raised md-hue-2">\n                <label>Password</label>\n                <input ng-model="user.password" type="password">\n            </md-input-container>\n        </md-card-content>\n        <md-card-actions layout="row" layout-align="center center">\n            <md-button class="md-primary  md-raised md-hue-2" ng-click="login()">Login</md-button>\n\n        </md-card-actions>\n    </md-card>\n\n\n</div>')}])}(),function(n){try{n=angular.module("Application")}catch(t){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/normal/main.html","<div>Normal</div>")}])}(),function(n){try{n=angular.module("Application")}catch(t){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/player/main.html","<div>Player</div>")}])}(),function(n){try{n=angular.module("Application")}catch(t){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/slider/main.html","<div>Slider</div>")}])}(),angular.module("Application").run(["$rootScope","$mdToast","$state",function(n,t,e){n.showToast=function(n){t.show(t.simple().textContent(n).theme("pick-theme").hideDelay(3e3))},n.go=function(n,t){e.go(n,t)}}]),angular.module("Application").config(["$stateProvider","$urlRouterProvider","$httpProvider","$mdThemingProvider",function(n,t,e,o){n.state("login",{url:"/login",onEnter:["$rootScope",function(n){getJSONLocal("user")&&n.go("app.normal")}],templateUrl:"/views/login/main.html",controller:"LoginCtrl"}).state("app",{url:"/",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],templateUrl:"/views/main.html",controller:"AppCtrl","abstract":!0}).state("app.normal",{url:"normal",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/normal/main.html",controller:"NormalCtrl"}}}).state("app.slider",{url:"slider",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/slider/main.html",controller:"SliderCtrl"}}}).state("app.player",{url:"player",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/player/main.html",controller:"PlayerCtrl"}}}),t.otherwise("/login"),e.interceptors.push("AuthInterceptor"),o.theme("default").backgroundPalette("teal",{"default":"500","hue-1":"100","hue-2":"600","hue-3":"A100"}).primaryPalette("lime",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("teal",{"default":"500"})}]),angular.module("Application").controller("AppCtrl",["$scope","OauthService",function(n,t){n.openMenu=function(n,t){originatorEv=t,n(t)},n.logout=function(){t.logout().Session(function(){deleteLocal("user"),$rootScope.go("login")},function(){})}}]),angular.module("Application").controller("LoginCtrl",["$rootScope","$scope","OauthService","RequestService",function(n,t,e,o){t.user={email:"",password:""},t.login=function(){async.waterfall([function(n){var e=emptyOrUndefined(t.user.email),o=emptyOrUndefined(t.user.password);e||o?e?n("Email Empty"):o&&n("Password Empty"):n()},function(n){e.login().Session(t.user,function(t){return t.error?n(t.error):void n(null,t.data)},o.ServerNotFound(n))},function(n,t){e.role().check({role:n.role},function(e){return e.error?t(e.error):void(2==e.data?t(null,n):o.NoRoleAuthorized(t)())},o.ServerNotFound(t))}],function(t,e){return t?n.showToast(t):(saveLocal("user",e),void n.go("app.normal"))})}}]),angular.module("Application").controller("NormalCtrl",function(){}),angular.module("Application").controller("PlayerCtrl",function(){}),angular.module("Application").controller("SliderCtrl",function(){}),angular.module("Application").factory("ApiService",["$resource","$location",function(n,t){return{env:"prod",prod:{protocol:"https",host:"pickyourday.herokuapp.com",port:"",root:"api"},dev:{protocol:"http",host:"localhost",port:"5000",root:"api"},getApiPath:function(n){var t=this[this.env];return t.protocol+"://"+t.host+(""!==t.port?":"+t.port:"")+"/"+t.root+"/"+n},rest:function(t,e,o){var r=n(this.getApiPath(t),o||{},e||{});return r}}}]),angular.module("Application").factory("AuthInterceptor",["$q","$location",function(n,t){return{request:function(n){n.headers=n.headers||{};var t=getJSONLocal("user"),t=getJSONLocal("user");return!n.headers.Authorization&&t&&(n.headers.Authorization=t.token),n},requestError:function(t){return n.reject(t)},response:function(t){return"ERROR"===t.data.status?n.reject(t):t||n.when(t)},responseError:function(e){return 403===e.status?(console.error("Error de acceso"),localStorage.user="",void t.path("/")):n.reject(e)}}}]),angular.module("Application").factory("OauthService",["ApiService",function(n){return{base:"oauth",login:function(){return n.rest(this.base,{Session:{method:"POST",params:{}}})},logout:function(){return n.rest(this.base+"/logout",{Session:{method:"GET",params:{}}})},role:function(){return n.rest(this.base+"/role/:role",{check:{method:"GET",params:{role:"@role"}}})}}}]),angular.module("Application").factory("RequestService",function(){return{ServerNotFound:ClosureMessage("Server Not Found"),NoRoleAuthorized:ClosureMessage("No Role Authorized")}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdXRpbHMuanMiLCJhcHBsaWNhdGlvbi5qcyIsInRlbXBsYXRlLWNhY2hlLmpzIiwiY29uZmlnL2Jvb3QuanMiLCJjb25maWcvZW52aXJvbm1lbnQuanMiLCJjb250cm9sbGVycy9hcHBsaWNhdGlvbl9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvbG9naW5fY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL25vcm1hbF9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcGxheWVyX2NvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9zbGlkZXJfY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvYXBpLnNlcnZpY2UuanMiLCJjb21wb25lbnRzL3NlcnZpY2VzL2ludGVyY2VwdG9yX3NlcnZpY2UuanMiLCJjb21wb25lbnRzL3NlcnZpY2VzL29hdXRoLnNlcnZpY2UuanMiLCJjb21wb25lbnRzL3NlcnZpY2VzL3JlcXVlc3Rfc2VydmljZS5qcyJdLCJuYW1lcyI6WyJzYXZlTG9jYWwiLCJrZXkiLCJkYXRhIiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldEpTT05Mb2NhbCIsInJlc3VsdCIsInN0cl9qc29uIiwidW5kZWZpbmVkIiwicGFyc2UiLCJlIiwiZGVsZXRlTG9jYWwiLCJyZW1vdmVJdGVtIiwiQ2xvc3VyZU1lc3NhZ2UiLCJtZXNzYWdlIiwiZm4iLCJlbXB0eU9yVW5kZWZpbmVkIiwidmFsdWUiLCJSYW5kUG9zaXRpb24iLCJ2IiwicmFuZ2UiLCJtaW4iLCJtYXgiLCJ4IiwiY2hhbmNlIiwiZmxvYXRpbmciLCJ5IiwieiIsIlJhbmRDb2xvciIsInJhbmdlQ29sb3IiLCJmaXhlZCIsInIiLCJnIiwiYiIsIlJhbmRTaXplIiwic2l6ZSIsIlJhbmRSb3RhdGlvbiIsIk51bWJlciIsImJvb2wiLCJhbmdsZSIsImludGVnZXIiLCJheGlzIiwiZ2VuZXJhdGUiLCJjb3VudCIsIkFycmF5IiwiYXBwbHkiLCJtYXAiLCJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCIkcm9vdFNjb3BlIiwiJG1kVG9hc3QiLCIkc3RhdGUiLCJzaG93VG9hc3QiLCJtc2ciLCJzaG93Iiwic2ltcGxlIiwidGV4dENvbnRlbnQiLCJ0aGVtZSIsImhpZGVEZWxheSIsImdvIiwic3RhdGUiLCJwYXJhbXMiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRodHRwUHJvdmlkZXIiLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJ1cmwiLCJvbkVudGVyIiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwiYWJzdHJhY3QiLCJ2aWV3cyIsImNvbnRlbnQiLCJvdGhlcndpc2UiLCJpbnRlcmNlcHRvcnMiLCJwdXNoIiwiYmFja2dyb3VuZFBhbGV0dGUiLCJkZWZhdWx0IiwiaHVlLTEiLCJodWUtMiIsImh1ZS0zIiwicHJpbWFyeVBhbGV0dGUiLCJhY2NlbnRQYWxldHRlIiwiJHNjb3BlIiwiT2F1dGhTZXJ2aWNlIiwib3Blbk1lbnUiLCIkbWRPcGVuTWVudSIsImV2Iiwib3JpZ2luYXRvckV2IiwibG9nb3V0IiwiU2Vzc2lvbiIsIlJlcXVlc3RTZXJ2aWNlIiwidXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCJsb2dpbiIsImFzeW5jIiwid2F0ZXJmYWxsIiwibmV4dCIsImlzRW1haWwiLCJpc1Bhc3N3b3JkIiwicmVzIiwiZXJyb3IiLCJTZXJ2ZXJOb3RGb3VuZCIsInJvbGUiLCJjaGVjayIsIk5vUm9sZUF1dGhvcml6ZWQiLCJlcnIiLCJmYWN0b3J5IiwiJHJlc291cmNlIiwiJGxvY2F0aW9uIiwiZW52IiwicHJvZCIsInByb3RvY29sIiwiaG9zdCIsInBvcnQiLCJyb290IiwiZGV2IiwiZ2V0QXBpUGF0aCIsInBhdGgiLCJhcGkiLCJ0aGlzIiwicmVzdCIsIm1ldGhvZHMiLCJkZWZhdWx0UGFyYW1zIiwicmVzb3VyY2UiLCIkcSIsInJlcXVlc3QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsInRva2VuIiwicmVxdWVzdEVycm9yIiwicmVqZWN0aW9uIiwicmVqZWN0IiwicmVzcG9uc2UiLCJzdGF0dXMiLCJ3aGVuIiwicmVzcG9uc2VFcnJvciIsImNvbnNvbGUiLCJBcGlTZXJ2aWNlIiwiYmFzZSIsIm1ldGhvZCJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsV0FBQUMsRUFBQUMsR0FDQUMsYUFBQUYsR0FBQUcsS0FBQUMsVUFBQUgsR0FHQSxRQUFBSSxjQUFBTCxHQUVBLEdBQUFNLEdBQUEsSUFDQSxLQUNBLEdBQUFDLEdBQUFMLGFBQUFGLEVBRUFRLFVBQUFELElBRUFELEVBQUFILEtBQUFNLE1BQUFGLElBR0EsTUFBQUcsSUFJQSxNQUFBSixHQUdBLFFBQUFLLGFBQUFYLEdBQ0FFLGFBQUFVLFdBQUFaLEdBR0EsUUFBQWEsZ0JBQUFDLEdBQ0EsTUFBQSxVQUFBQyxHQUNBLE1BQUEsWUFDQUEsRUFBQUQsS0FLQSxRQUFBRSxrQkFBQUMsR0FDQSxNQUFBLFNBQUFBLEdBQUEsS0FBQUEsRUFJQSxRQUFBQyxjQUFBQyxHQUNBLEdBQUFDLEdBQUFELElBQUFFLElBQUEsRUFBQUMsSUFBQSxLQUNBQyxFQUFBQyxPQUFBQyxTQUFBTCxHQUNBTSxFQUFBRixPQUFBQyxTQUFBTCxHQUNBTyxFQUFBSCxPQUFBQyxTQUFBTCxFQUNBLFFBQUFHLEVBQUFHLEVBQUFDLEdBR0EsUUFBQUMsV0FBQVQsR0FDQSxHQUFBVSxHQUFBVixJQUFBRSxJQUFBLEVBQUFDLElBQUEsRUFBQVEsTUFBQSxHQUNBQyxFQUFBUCxPQUFBQyxTQUFBSSxHQUNBRyxFQUFBUixPQUFBQyxTQUFBSSxHQUNBSSxFQUFBVCxPQUFBQyxTQUFBSSxFQUNBLFFBQUFFLEVBQUFDLEVBQUFDLEVBQUEsR0FHQSxRQUFBQyxVQUFBZixHQUNBLEdBQUFDLEdBQUFELElBQUFFLElBQUEsR0FBQUMsSUFBQSxFQUFBUSxNQUFBLEdBQ0FLLEVBQUFYLE9BQUFDLFNBQUFMLEVBQ0EsUUFBQWUsRUFBQUEs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QyxPQUlBckUsR0FFQXNFLGFBQUEsU0FBQUMsR0FDQSxNQUFBTixHQUFBTyxPQUFBRCxJQUVBRSxTQUFBLFNBQUFBLEdBQ0EsTUFBQSxVQUFBQSxFQUFBMUksS0FBQTJJLE9BQ0FULEVBQUFPLE9BQUFDLEdBRUFBLEdBQUFSLEVBQUFVLEtBQUFGLElBRUFHLGNBQUEsU0FBQUwsR0FDQSxNQUFBLE9BQUFBLEVBQUFHLFFBQ0FHLFFBQUFwQyxNQUFBLG1CQUNBekcsYUFBQStGLEtBQUEsT0FDQWtCLEdBQUFTLEtBQUEsTUFHQU8sRUFBQU8sT0FBQUQsUUMvQkF6RixRQUFBQyxPQUFBLGVBQ0FnRSxRQUFBLGdCQUFBLGFBQUEsU0FBQStCLEdBRUEsT0FFQUMsS0FBQSxRQUNBN0MsTUFBQSxXQUNBLE1BQUE0QyxHQUFBakIsS0FBQUQsS0FBQW1CLE1BQ0FsRCxTQUFBbUQsT0FBQSxPQUFBakYsY0FHQTZCLE9BQUEsV0FDQSxNQUFBa0QsR0FBQWpCLEtBQUFELEtBQUFtQixLQUFBLFdBQ0FsRCxTQUFBbUQsT0FBQSxNQUFBakYsY0FHQTRDLEtBQUEsV0FDQSxNQUFBbUMsR0FBQWpCLEtBQUFELEtBQUFtQixLQUFBLGVBQ0FuQyxPQUFBb0MsT0FBQSxNQUFBakYsUUFBQTRDLEtBQUEsaUJDbEJBN0QsUUFBQUMsT0FBQSxlQUNBZ0UsUUFBQSxpQkFBQSxXQUVBLE9BRUFMLGVBQUEvRixlQUFBLG9CQUVBa0csaUJBQUFsRyxlQUFBIiwiZmlsZSI6ImJ1bmRsZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBzYXZlTG9jYWwoa2V5LCBkYXRhKSB7XHJcbiAgICBsb2NhbFN0b3JhZ2Vba2V5XSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXRKU09OTG9jYWwoa2V5KSB7XHJcblxyXG4gICAgdmFyIHJlc3VsdCA9IG51bGw7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBzdHJfanNvbiA9IGxvY2FsU3RvcmFnZVtrZXldO1xyXG5cclxuICAgICAgICBpZiAoc3RyX2pzb24hPT11bmRlZmluZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2Uoc3RyX2pzb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGRlbGV0ZUxvY2FsKGtleSkge1xyXG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcclxufVxyXG5cclxuZnVuY3Rpb24gQ2xvc3VyZU1lc3NhZ2UobWVzc2FnZSl7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oZm4pe1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICBmbihtZXNzYWdlKTtcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gZW1wdHlPclVuZGVmaW5lZCh2YWx1ZSl7XHJcbiAgICByZXR1cm4gdmFsdWU9PXZvaWQgMCB8fCB2YWx1ZT09PVwiXCI7XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBSYW5kUG9zaXRpb24odikge1xyXG4gICAgdmFyIHJhbmdlID0gdiB8fCB7IG1pbjogMCwgbWF4OiAxMDAgfTtcclxuICAgIHZhciB4ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHZhciB5ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHZhciB6ID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHJldHVybiBbeCwgeSwgel07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFJhbmRDb2xvcih2KSB7XHJcbiAgICB2YXIgcmFuZ2VDb2xvciA9IHYgfHwgeyBtaW46IDAsIG1heDogMSwgZml4ZWQ6IDIgfTtcclxuICAgIHZhciByID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlQ29sb3IpO1xyXG4gICAgdmFyIGcgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2VDb2xvcik7XHJcbiAgICB2YXIgYiA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZUNvbG9yKTtcclxuICAgIHJldHVybiBbciwgZywgYiwgMV07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIFJhbmRTaXplKHYpIHtcclxuICAgIHZhciByYW5nZSA9IHYgfHwgeyBtaW46IDAuMSwgbWF4OiAyLCBmaXhlZDogMSB9O1xyXG4gICAgdmFyIHNpemUgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2UpO1xyXG4gICAgcmV0dXJuIFtzaXplLCBzaXplLCBzaXplXTtcclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIFJhbmRSb3RhdGlvbih2KXtcclxuICAgIHZhciByYW5nZSA9IHYgfHwgeyBtaW46IDAsIG1heDogMzYwfTtcclxuICAgIHZhciB4PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHZhciB5PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHZhciB6PU51bWJlcihjaGFuY2UuYm9vbCgpKTtcclxuICAgIHJldHVybiAge1xyXG4gICAgICAgIGFuZ2xlOmNoYW5jZS5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDM2MH0pLFxyXG4gICAgICAgIGF4aXM6W3gseSx6XVxyXG4gICAgfVxyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZ2VuZXJhdGUoZm4pIHtcclxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY291bnQgPSBjaGFuY2UuaW50ZWdlcih7IG1pbjogMCwgbWF4OiAxMDAgfSk7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmFwcGx5KDAsIEFycmF5KGNvdW50KSkubWFwKGZuKTtcclxuICAgIH07XHJcbn0iLCJ2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgWyd1aS5yb3V0ZXInLCBcIm5nUmVzb3VyY2VcIiwnbmdBbmltYXRlJywgJ25nTWF0ZXJpYWwnXSk7IiwiKGZ1bmN0aW9uKG1vZHVsZSkge1xudHJ5IHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJyk7XG59IGNhdGNoIChlKSB7XG4gIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFtdKTtcbn1cbm1vZHVsZS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnL3ZpZXdzL21haW4uaHRtbCcsXG4gICAgJ1xcbicgK1xuICAgICc8bWQtdG9vbGJhciBjbGFzcz1cIm1kLWFjY2VudCBtZC13aGl0ZWZyYW1lLTFkcFwiPlxcbicgK1xuICAgICcgICAgPGRpdiBjbGFzcz1cIm1kLXRvb2xiYXItdG9vbHNcIj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgIDxtZC1tZW51IGZsZXg9XCI1XCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cIlR5cGUgU3RhdHNcIiBjbGFzcz1cIm1kLWljb24tYnV0dG9uXCIgbmctY2xpY2s9XCJvcGVuTWVudSgkbWRPcGVuTWVudSwgJGV2ZW50KVwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPG1kLWljb24gbWQtbWVudS1vcmlnaW4gbWQtZm9udC1pY29uPVwibWRpLWNoYXJ0LWFyZWFzcGxpbmVcIiBjbGFzcz1cIm1kaVwiPjwvbWQtaWNvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1tZW51LWNvbnRlbnQgd2lkdGg9XCI0XCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtbWVudS1pdGVtPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxtZC1idXR0b24gdWktc3JlZj1cImFwcC5ub3JtYWxcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPG1kLWljb24gbWQtZm9udC1pY29uPVwibWRpLWNoYXJ0LWJ1YmJsZVwiIGNsYXNzPVwibWRpXCI+PC9tZC1pY29uPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICBOb3JtYWxcXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDwvbWQtbWVudS1pdGVtPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPG1kLW1lbnUtaXRlbT5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8bWQtYnV0dG9uICB1aS1zcmVmPVwiYXBwLnNsaWRlclwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bWQtaWNvbiBtZC1mb250LWljb249XCJtZGktY2xvY2stc3RhcnRcIiBjbGFzcz1cIm1kaVwiPjwvbWQtaWNvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICAgICAgU2xpZGVyXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPC9tZC1idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L21kLW1lbnUtaXRlbT5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxtZC1tZW51LWRpdmlkZXI+PC9tZC1tZW51LWRpdmlkZXI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtbWVudS1pdGVtPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxtZC1idXR0b24gIHVpLXNyZWY9XCJhcHAucGxheWVyXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxtZC1pY29uIG1kLWZvbnQtaWNvbj1cIm1kaS1wbGF5LWJveC1vdXRsaW5lXCIgY2xhc3M9XCJtZGlcIj48L21kLWljb24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIFBsYXllclxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDwvbWQtYnV0dG9uPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPC9tZC1tZW51LWl0ZW0+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDwvbWQtbWVudS1jb250ZW50PlxcbicgK1xuICAgICcgICAgICAgIDwvbWQtbWVudT5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgPGgyPlxcbicgK1xuICAgICcgICAgICAgICAgICA8c3Bhbj5QaWNreW91cmRheSAzRDwvc3Bhbj5cXG4nICtcbiAgICAnICAgICAgICA8L2gyPlxcbicgK1xuICAgICcgICAgICAgIDxzcGFuIGZsZXg+PC9zcGFuPlxcbicgK1xuICAgICcgICAgICAgIDxtZC1idXR0b24gYXJpYS1sYWJlbD1cImxvZ291dFwiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBzdHlsZT1cIm1hcmdpbi1yaWdodDogMHB4O1wiIG5nLWNsaWNrPVwibG9nb3V0KClcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPG1kLWljb24gbWQtZm9udC1pY29uPVwibWRpLXBvd2VyXCIgY2xhc3M9XCJtZGlcIj48L21kLWljb24+XFxuJyArXG4gICAgJyAgICAgICAgPC9tZC1idXR0b24+XFxuJyArXG4gICAgJyAgICA8L2Rpdj5cXG4nICtcbiAgICAnPC9tZC10b29sYmFyPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnXFxuJyArXG4gICAgJzxkaXYgdWktdmlldz1cImNvbnRlbnRcIj48L2Rpdj4nKTtcbn1dKTtcbn0pKCk7XG5cbihmdW5jdGlvbihtb2R1bGUpIHtcbnRyeSB7XG4gIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpO1xufSBjYXRjaCAoZSkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nLCBbXSk7XG59XG5tb2R1bGUucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJy92aWV3cy9sb2dpbi9tYWluLmh0bWwnLFxuICAgICc8ZGl2IGxheW91dD1cImNvbHVtblwiIGxheW91dC1hbGlnbj1cImNlbnRlciBjZW50ZXJcIj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgIDxtZC1jYXJkPlxcbicgK1xuICAgICcgICAgICAgIDxtZC1jYXJkLXRpdGxlPlxcbicgK1xuICAgICcgICAgICAgICAgICA8bWQtY2FyZC10aXRsZS10ZXh0PlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9XCJtZC1oZWFkbGluZVwiPlBpY2t5b3VyZGF5IDNEPC9zcGFuPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1jYXJkLXRpdGxlLXRleHQ+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgIDwvbWQtY2FyZC10aXRsZT5cXG4nICtcbiAgICAnICAgICAgICA8bWQtY2FyZC1jb250ZW50IGxheW91dD1cImNvbHVtblwiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1pbnB1dC1jb250YWluZXIgY2xhc3M9XCJtZC1wcmltYXJ5IG1kLXJhaXNlZCBtZC1odWUtMlwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGxhYmVsPkVtYWlsPC9sYWJlbD5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInVzZXIuZW1haWxcIiB0eXBlPVwiZW1haWxcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICA8bWQtaW5wdXQtY29udGFpbmVyIGNsYXNzPVwibWQtcHJpbWFyeSBtZC1yYWlzZWQgbWQtaHVlLTJcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxsYWJlbD5QYXNzd29yZDwvbGFiZWw+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8aW5wdXQgbmctbW9kZWw9XCJ1c2VyLnBhc3N3b3JkXCIgdHlwZT1cInBhc3N3b3JkXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDwvbWQtaW5wdXQtY29udGFpbmVyPlxcbicgK1xuICAgICcgICAgICAgIDwvbWQtY2FyZC1jb250ZW50PlxcbicgK1xuICAgICcgICAgICAgIDxtZC1jYXJkLWFjdGlvbnMgbGF5b3V0PVwicm93XCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiPlxcbicgK1xuICAgICcgICAgICAgICAgICA8bWQtYnV0dG9uIGNsYXNzPVwibWQtcHJpbWFyeSAgbWQtcmFpc2VkIG1kLWh1ZS0yXCIgbmctY2xpY2s9XCJsb2dpbigpXCI+TG9naW48L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgPC9tZC1jYXJkLWFjdGlvbnM+XFxuJyArXG4gICAgJyAgICA8L21kLWNhcmQ+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnPC9kaXY+Jyk7XG59XSk7XG59KSgpO1xuXG4oZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdmlld3Mvbm9ybWFsL21haW4uaHRtbCcsXG4gICAgJzxkaXY+Tm9ybWFsPC9kaXY+Jyk7XG59XSk7XG59KSgpO1xuXG4oZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdmlld3MvcGxheWVyL21haW4uaHRtbCcsXG4gICAgJzxkaXY+UGxheWVyPC9kaXY+Jyk7XG59XSk7XG59KSgpO1xuXG4oZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdmlld3Mvc2xpZGVyL21haW4uaHRtbCcsXG4gICAgJzxkaXY+U2xpZGVyPC9kaXY+Jyk7XG59XSk7XG59KSgpO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5ydW4oZnVuY3Rpb24oJHJvb3RTY29wZSwgICRtZFRvYXN0LCAkc3RhdGUpe1xyXG5cclxuICAgICRyb290U2NvcGUuc2hvd1RvYXN0ID0gZnVuY3Rpb24obXNnKSB7XHJcbiAgICAgIFxyXG4gICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXHJcbiAgICAgICAgICAgIC50ZXh0Q29udGVudChtc2cpXHJcbiAgICAgICAgICAgIC50aGVtZShcInBpY2stdGhlbWVcIilcclxuICAgICAgICAgICAgLmhpZGVEZWxheSgzMDAwKVxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICAgJHJvb3RTY29wZS5nbyA9IGZ1bmN0aW9uIChzdGF0ZSwgcGFyYW1zKSB7XHJcbiAgICAgICAgJHN0YXRlLmdvKHN0YXRlLCBwYXJhbXMpO1xyXG4gICAgfTtcclxuXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRodHRwUHJvdmlkZXIsICAkbWRUaGVtaW5nUHJvdmlkZXIpe1xyXG5cclxuXHJcbiAgICAkc3RhdGVQcm92aWRlclxyXG4gICAgICAgIC5zdGF0ZShcImxvZ2luXCIsIHtcclxuICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXHJcbiAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgaWYgKGdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwiYXBwLm5vcm1hbFwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbG9naW4vbWFpbi5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnTG9naW5DdHJsJyAgICAgIFxyXG5cclxuICAgIH0pXHJcbiAgICAgICAgLnN0YXRlKFwiYXBwXCIsIHtcclxuICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICBpZiAoIWdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL21haW4uaHRtbCcsXHJcbiAgICAgICAgY29udHJvbGxlcjogJ0FwcEN0cmwnLFxyXG4gICAgICAgIGFic3RyYWN0OnRydWVcclxuXHJcbiAgICB9KVxyXG4gICAgICAgIC5zdGF0ZShcImFwcC5ub3JtYWxcIiwge1xyXG4gICAgICAgIHVybDogJ25vcm1hbCcsXHJcbiAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgaWYgKCFnZXRKU09OTG9jYWwoXCJ1c2VyXCIpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImxvZ2luXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICBjb250ZW50OiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9ub3JtYWwvbWFpbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdOb3JtYWxDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICAuc3RhdGUoXCJhcHAuc2xpZGVyXCIsIHtcclxuICAgICAgICB1cmw6ICdzbGlkZXInLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmICghZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgY29udGVudDoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3Mvc2xpZGVyL21haW4uaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnU2xpZGVyQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gIFxyXG4gICAgfSlcclxuICAgICAuc3RhdGUoXCJhcHAucGxheWVyXCIsIHtcclxuICAgICAgICB1cmw6ICdwbGF5ZXInLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmICghZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgY29udGVudDoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvcGxheWVyL21haW4uaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnUGxheWVyQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gIFxyXG4gICAgfSlcclxuXHJcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKFwiL2xvZ2luXCIpO1xyXG5cclxuICAgICRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpO1xyXG5cclxuICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgLmJhY2tncm91bmRQYWxldHRlKCd0ZWFsJywge1xyXG4gICAgICAnZGVmYXVsdCc6ICc1MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcclxuICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgJ2h1ZS0yJzogJzYwMCcsIC8vIHVzZSBzaGFkZSA2MDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMjwvY29kZT4gY2xhc3NcclxuICAgICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXHJcbiAgICB9KVxyXG4gICAgLnByaW1hcnlQYWxldHRlKCdsaW1lJywge1xyXG4gICAgICAnZGVmYXVsdCc6ICc0MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcclxuICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgJ2h1ZS0yJzogJzYwMCcsIC8vIHVzZSBzaGFkZSA2MDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMjwvY29kZT4gY2xhc3NcclxuICAgICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXHJcbiAgICB9KVxyXG4gICAgLy8gSWYgeW91IHNwZWNpZnkgbGVzcyB0aGFuIGFsbCBvZiB0aGUga2V5cywgaXQgd2lsbCBpbmhlcml0IGZyb20gdGhlXHJcbiAgICAvLyBkZWZhdWx0IHNoYWRlc1xyXG4gICAgLmFjY2VudFBhbGV0dGUoJ3RlYWwnLCB7XHJcbiAgICAgICdkZWZhdWx0JzogJzUwMCcgLy8gdXNlIHNoYWRlIDIwMCBmb3IgZGVmYXVsdCwgYW5kIGtlZXAgYWxsIG90aGVyIHNoYWRlcyB0aGUgc2FtZVxyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbn0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdBcHBDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBPYXV0aFNlcnZpY2Upe1xyXG4gICAgXHJcbiAgICBcclxuICAgICRzY29wZS5vcGVuTWVudSA9IGZ1bmN0aW9uKCRtZE9wZW5NZW51LCBldikge1xyXG4gICAgICBvcmlnaW5hdG9yRXYgPSBldjtcclxuICAgICAgJG1kT3Blbk1lbnUoZXYpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgXHJcbiAgICAkc2NvcGUubG9nb3V0PWZ1bmN0aW9uKCl7XHJcbiAgICAgICAgT2F1dGhTZXJ2aWNlLiBsb2dvdXQoKS5TZXNzaW9uKGZ1bmN0aW9uKCl7XHJcblx0XHQgZGVsZXRlTG9jYWwoXCJ1c2VyXCIpO1xyXG4gICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTsgICBcclxuXHR9LCBmdW5jdGlvbigpe30pO1xyXG4gICAgfVxyXG4gICAgXHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCBPYXV0aFNlcnZpY2UsIFJlcXVlc3RTZXJ2aWNlKXtcclxuICAgIFxyXG5cclxuICAgIFxyXG4gICAgJHNjb3BlLnVzZXIgPSB7ZW1haWw6XCJcIiwgcGFzc3dvcmQ6XCJcIn07XHJcbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgYXN5bmMud2F0ZXJmYWxsKFtcclxuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIHZhbGlkYXRlKG5leHQpe1xyXG4gICAgICAgICAgICAgICAgdmFyIGlzRW1haWw9ZW1wdHlPclVuZGVmaW5lZCgkc2NvcGUudXNlci5lbWFpbCk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNQYXNzd29yZD1lbXB0eU9yVW5kZWZpbmVkKCRzY29wZS51c2VyLnBhc3N3b3JkKTtcclxuICAgICAgICAgICAgICAgIGlmKGlzRW1haWwgfHwgaXNQYXNzd29yZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoaXNFbWFpbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoXCJFbWFpbCBFbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXNQYXNzd29yZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIG5leHQoXCJQYXNzd29yZCBFbXB0eVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZnVuY3Rpb24gbG9naW4obmV4dCl7XHJcblxyXG4gICAgICAgICAgICAgICAgT2F1dGhTZXJ2aWNlLmxvZ2luKCkuU2Vzc2lvbigkc2NvcGUudXNlciwgZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZXJyb3IpcmV0dXJuIG5leHQocmVzLmVycm9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dChudWxsLCByZXMuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSwgUmVxdWVzdFNlcnZpY2UuU2VydmVyTm90Rm91bmQobmV4dCkpO1xyXG5cclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGNoZWNrUm9sZSh1c2VyLCBuZXh0KXtcclxuICAgICAgICAgICAgICAgIE9hdXRoU2VydmljZS5yb2xlKCkuY2hlY2soe3JvbGU6dXNlci5yb2xlfSwgZnVuY3Rpb24ocmVzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZXJyb3IpcmV0dXJuIG5leHQocmVzLmVycm9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYocmVzLmRhdGE9PTIpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChudWxsLCB1c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgUmVxdWVzdFNlcnZpY2UuTm9Sb2xlQXV0aG9yaXplZChuZXh0KSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB9LCBSZXF1ZXN0U2VydmljZS5TZXJ2ZXJOb3RGb3VuZChuZXh0KSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICBdLCBmdW5jdGlvbihlcnIsIHVzZXIpe1xyXG4gICAgICAgICAgICBpZihlcnIpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRyb290U2NvcGUuc2hvd1RvYXN0KGVycik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2F2ZUxvY2FsKFwidXNlclwiLCB1c2VyKTtcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImFwcC5ub3JtYWxcIik7XHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxuICAgIH07XHJcblxyXG5cclxuICAgIFxyXG4gICAgXHJcbiAgICBcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdOb3JtYWxDdHJsJywgZnVuY3Rpb24oKXtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdQbGF5ZXJDdHJsJywgZnVuY3Rpb24oKXtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdTbGlkZXJDdHJsJywgZnVuY3Rpb24oKXtcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5mYWN0b3J5KFwiQXBpU2VydmljZVwiLCBmdW5jdGlvbigkcmVzb3VyY2UsICRsb2NhdGlvbil7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICAvL2VudjokbG9jYXRpb24uYWJzVXJsKCkuaW5kZXhPZihcImxvY2FsaG9zdFwiKT09LTE/XCJwcm9kXCI6XCJkZXZcIixcclxuICAgICAgICBlbnY6XCJwcm9kXCIsXHJcbiAgICAgICAgcHJvZDp7XHJcbiAgICAgICAgICAgIHByb3RvY29sOlwiaHR0cHNcIixcclxuICAgICAgICAgICAgaG9zdDpcInBpY2t5b3VyZGF5Lmhlcm9rdWFwcC5jb21cIixcclxuICAgICAgICAgICAgcG9ydDpcIlwiLFxyXG4gICAgICAgICAgICByb290OlwiYXBpXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGRldjp7XHJcbiAgICAgICAgICAgIHByb3RvY29sOlwiaHR0cFwiLFxyXG4gICAgICAgICAgICBob3N0OlwibG9jYWxob3N0XCIsXHJcbiAgICAgICAgICAgIHBvcnQ6XCI1MDAwXCIsXHJcbiAgICAgICAgICAgIHJvb3Q6XCJhcGlcIlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdldEFwaVBhdGg6ZnVuY3Rpb24ocGF0aCl7XHJcbiAgICAgICAgICAgIHZhciBhcGk9dGhpc1t0aGlzLmVudl07XHJcbiAgICAgICAgICAgIHJldHVybiBhcGkucHJvdG9jb2wrXCI6Ly9cIithcGkuaG9zdCsoYXBpLnBvcnQhPT1cIlwiPyhcIjpcIithcGkucG9ydCk6XCJcIikrXCIvXCIrYXBpLnJvb3QrXCIvXCIrcGF0aDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZXN0OmZ1bmN0aW9uKHBhdGgsIG1ldGhvZHMsIGRlZmF1bHRQYXJhbXMpe1xyXG4gICAgICAgICAgICB2YXIgcmVzb3VyY2U9JHJlc291cmNlKFxyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRBcGlQYXRoKHBhdGgpLFxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdFBhcmFtcyB8fCB7fSxcclxuICAgICAgICAgICAgICAgIG1ldGhvZHMgfHwge31cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgcmV0dXJuIHJlc291cmNlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5mYWN0b3J5KFwiQXV0aEludGVyY2VwdG9yXCIsIGZ1bmN0aW9uKCRxLCAkbG9jYXRpb24pe1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXF1ZXN0OiBmdW5jdGlvbihjb25maWcpe1xyXG4gICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xyXG5cclxuICAgICAgICAgICAgdmFyIHVzZXI9Z2V0SlNPTkxvY2FsKFwidXNlclwiKTtcclxuICAgICAgICAgICAgdmFyIHVzZXI9Z2V0SlNPTkxvY2FsKFwidXNlclwiKTtcclxuICAgICAgICAgICAgaWYgKCFjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uICYmIHVzZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzLkF1dGhvcml6YXRpb24gPSB1c2VyLnRva2VuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlcXVlc3RFcnJvcjogZnVuY3Rpb24ocmVqZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVqZWN0aW9uKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlc3BvbnNlOiBmdW5jdGlvbihyZXNwb25zZSl7XHJcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuc3RhdHVzID09PSAnRVJST1InKSB7IC8vRm9yY2UgZXJyb3JcclxuICAgICAgICAgICAgICAgIHJldHVybiAkcS5yZWplY3QocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSB8fCAkcS53aGVuKHJlc3BvbnNlKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJlc3BvbnNlRXJyb3I6IGZ1bmN0aW9uKHJlamVjdGlvbil7XHJcbiAgICAgICAgICAgIGlmKHJlamVjdGlvbi5zdGF0dXMgPT09IDQwMykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZGUgYWNjZXNvJyk7XHJcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UudXNlciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlamVjdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcclxuIiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5mYWN0b3J5KFwiT2F1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKEFwaVNlcnZpY2Upe1xyXG5cclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICAgIGJhc2U6XCJvYXV0aFwiLFxyXG4gICAgICAgIGxvZ2luOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnJlc3QodGhpcy5iYXNlLHtcclxuICAgICAgICAgICAgICAgIFNlc3Npb246e21ldGhvZDpcIlBPU1RcIiwgcGFyYW1zOnt9fVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGxvZ291dDpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5yZXN0KHRoaXMuYmFzZStcIi9sb2dvdXRcIiwge1xyXG4gICAgICAgICAgICAgICAgU2Vzc2lvbjp7bWV0aG9kOlwiR0VUXCIsIHBhcmFtczp7fX1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByb2xlOmZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgIHJldHVybiBBcGlTZXJ2aWNlLnJlc3QodGhpcy5iYXNlK1wiL3JvbGUvOnJvbGVcIiwge1xyXG4gICAgICAgICAgICAgICAgICBjaGVjazp7bWV0aG9kOlwiR0VUXCIsIHBhcmFtczp7cm9sZTpcIkByb2xlXCJ9fSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH07XHJcbn0pO1xyXG5cclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuZmFjdG9yeShcIlJlcXVlc3RTZXJ2aWNlXCIsIGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgIFxyXG4gICAgICAgIFNlcnZlck5vdEZvdW5kOiBDbG9zdXJlTWVzc2FnZShcIlNlcnZlciBOb3QgRm91bmRcIiksXHJcblxyXG4gICAgICAgIE5vUm9sZUF1dGhvcml6ZWQ6IENsb3N1cmVNZXNzYWdlKFwiTm8gUm9sZSBBdXRob3JpemVkXCIpLFxyXG4gICAgICAgIFxyXG4gICAgXHJcbiAgICB9O1xyXG59KTtcclxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
