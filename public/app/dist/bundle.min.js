function saveLocal(n,e){localStorage[n]=JSON.stringify(e)}function getJSONLocal(n){var e=null;try{var t=localStorage[n];void 0!==t&&(e=JSON.parse(t))}catch(o){}return e}function deleteLocal(n){localStorage.removeItem(n)}function ClosureMessage(n){return function(e){return function(){e(n)}}}function emptyOrUndefined(n){return void 0==n||""===n}function RandPosition(n){var e=n||{min:0,max:100},t=chance.floating(e),o=chance.floating(e),a=chance.floating(e);return[t,o,a]}function RandColor(n){var e=n||{min:0,max:1,fixed:2},t=chance.floating(e),o=chance.floating(e),a=chance.floating(e);return[t,o,a,1]}function RandSize(n){var e=n||{min:.1,max:2,fixed:1},t=chance.floating(e);return[t,t,t]}function RandRotation(n){var e=Number(chance.bool()),t=Number(chance.bool()),o=Number(chance.bool());return{angle:chance.integer({min:0,max:360}),axis:[e,t,o]}}function generate(n){return function(){var e=chance.integer({min:0,max:100});return Array.apply(0,Array(e)).map(n)}}var app=angular.module("Application",["ui.router","ngResource","ngAnimate","ngMaterial","alexandra"]);!function(n){try{n=angular.module("Application")}catch(e){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/main.html",'\n<md-toolbar class="md-accent md-whiteframe-1dp">\n    <div class="md-toolbar-tools">\n\n\n        <md-menu flex="5">\n            <md-button aria-label="Type Stats" class="md-icon-button" ng-click="openMenu($mdOpenMenu, $event)">\n                <md-icon md-menu-origin md-font-icon="mdi-chart-areaspline" class="mdi"></md-icon>\n            </md-button>\n            <md-menu-content width="4">\n                <md-menu-item>\n                    <md-button ui-sref="app.normal">\n                        <md-icon md-font-icon="mdi-chart-bubble" class="mdi"></md-icon>\n                        Normal\n                    </md-button>\n                </md-menu-item>\n                <md-menu-item>\n                    <md-button  ui-sref="app.slider">\n                        <md-icon md-font-icon="mdi-clock-start" class="mdi"></md-icon>\n                        Slider\n                    </md-button>\n                </md-menu-item>\n                <md-menu-divider></md-menu-divider>\n                <md-menu-item>\n                    <md-button  ui-sref="app.player">\n                        <md-icon md-font-icon="mdi-play-box-outline" class="mdi"></md-icon>\n                        Player\n                    </md-button>\n                </md-menu-item>\n            </md-menu-content>\n        </md-menu>\n\n        <h2>\n            <span>Pickyourday 3D</span>\n        </h2>\n        <span flex></span>\n        <md-button aria-label="logout" class="md-icon-button" style="margin-right: 0px;" ng-click="logout()">\n            <md-icon md-font-icon="mdi-power" class="mdi"></md-icon>\n        </md-button>\n    </div>\n</md-toolbar>\n\n\n<div ui-view="content"></div>')}])}(),function(n){try{n=angular.module("Application")}catch(e){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/login/main.html",'<div layout="column" layout-align="center center">\n\n\n\n    <md-card>\n        <md-card-title>\n            <md-card-title-text>\n                <span class="md-headline">Pickyourday 3D</span>\n\n            </md-card-title-text>\n\n        </md-card-title>\n        <md-card-content layout="column">\n\n\n            <md-input-container class="md-primary md-raised md-hue-2">\n                <label>Email</label>\n                <input ng-model="user.email" type="email">\n            </md-input-container>\n\n            <md-input-container class="md-primary md-raised md-hue-2">\n                <label>Password</label>\n                <input ng-model="user.password" type="password">\n            </md-input-container>\n        </md-card-content>\n        <md-card-actions layout="row" layout-align="center center">\n            <md-button class="md-primary  md-raised md-hue-2" ng-click="login()">Login</md-button>\n\n        </md-card-actions>\n    </md-card>\n\n\n</div>')}])}(),function(n){try{n=angular.module("Application")}catch(e){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/normal/main.html","<div>Normal</div>\n\n")}])}(),function(n){try{n=angular.module("Application")}catch(e){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/player/main.html",'<md-progress-linear md-mode="indeterminate" ng-if="loading"></md-progress-linear>\n<div class="player-content" layout="row">\n    <canvas alexandra-view data-id="view_1" alexandra-config="config" alexandra-source="data" width="800" height="600"></canvas>\n    <div flex="35" layout="column" layout-align="center strech">\n        <div flex layout="row" layout-align="center center">\n            <md-button ng-click="play()" ng-if="!loading">\n                <md-icon md-font-icon="mdi-play" class="mdi"></md-icon>\n                Play\n            </md-button>\n        </div>\n\n        <div flex>\n            <div ng-repeat="vm in data">\n                {{vm.position}}\n\n            </div>\n        </div>\n\n        <div>\n            <md-slider-container>\n               <span class="md-body-1">{{values.index}}</span>\n                <md-slider class="md-primary" md-discrete step="1" min="1" max="30" aria-label="rating" ng-show="!loading" ng-model="values.index" ng-disabled="true">\n                </md-slider>\n            </md-slider-container>\n        </div>\n\n\n\n\n    </div>\n\n</div>\n\n\n')}])}(),function(n){try{n=angular.module("Application")}catch(e){n=angular.module("Application",[])}n.run(["$templateCache",function(n){n.put("/views/slider/main.html","<div>Slider</div>\n{{coords.x}}, {{coords.y}}, {{coords.z}}")}])}(),angular.module("Application").run(["$rootScope","$mdToast","$state",function(n,e,t){n.showToast=function(n){e.show(e.simple().textContent(n).theme("pick-theme").hideDelay(3e3))},n.go=function(n,e){t.go(n,e)}}]),angular.module("Application").config(["$stateProvider","$urlRouterProvider","$httpProvider","$mdThemingProvider",function(n,e,t,o){n.state("login",{url:"/login",onEnter:["$rootScope",function(n){getJSONLocal("user")&&n.go("app.player")}],templateUrl:"/views/login/main.html",controller:"LoginCtrl"}).state("app",{url:"/",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],templateUrl:"/views/main.html",controller:"AppCtrl","abstract":!0}).state("app.normal",{url:"normal",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/normal/main.html",controller:"NormalCtrl"}}}).state("app.slider",{url:"slider",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/slider/main.html",controller:"SliderCtrl"}}}).state("app.player",{url:"player",onEnter:["$rootScope",function(n){getJSONLocal("user")||n.go("login")}],views:{content:{templateUrl:"/views/player/main.html",controller:"PlayerCtrl"}}}),e.otherwise("/login"),t.interceptors.push("AuthInterceptor"),o.theme("default").backgroundPalette("teal",{"default":"500","hue-1":"100","hue-2":"600","hue-3":"A100"}).primaryPalette("lime",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("teal",{"default":"500"})}]),angular.module("Application").controller("AppCtrl",["$rootScope","$scope","OauthService",function(n,e,t){e.openMenu=function(n,e){originatorEv=e,n(e)},e.logout=function(){t.logout().Session(function(){deleteLocal("user"),n.go("login")},function(){})}}]),angular.module("Application").controller("LoginCtrl",["$rootScope","$scope","OauthService","RequestService",function(n,e,t,o){e.user={email:"",password:""},e.login=function(){async.waterfall([function(n){var t=emptyOrUndefined(e.user.email),o=emptyOrUndefined(e.user.password);t||o?t?n("Email Empty"):o&&n("Password Empty"):n()},function(n){t.login().Session(e.user,function(e){return e.error?n(e.error):void n(null,e.data)},o.ServerNotFound(n))},function(n,e){t.role().check({role:n.role},function(t){return t.error?e(t.error):void(2==t.data?e(null,n):o.NoRoleAuthorized(e)())},o.ServerNotFound(e))}],function(e,t){return e?n.showToast(e):(saveLocal("user",t),void n.go("app.normal"))})}}]),angular.module("Application").controller("NormalCtrl",function(){}),angular.module("Application").controller("PlayerCtrl",["$scope","CompanyService","$timeout",function(n,e,t){function o(e,o,a,l){var c=o.reduce(function(n,e,t){var o=e.position,r=a[t].position;return _.isEqual(o,r)||(n.length++,n.current["x_"+t]=o[0],n.current["y_"+t]=o[1],n.current["z_"+t]=o[2],n.next["x_"+t]=r[0],n.next["y_"+t]=r[1],n.next["z_"+t]=r[2]),n},{current:{},next:{},length:0});if(n.values.index=e+1,console.log(c),c.length>0){new TWEEN.Tween(c.current).to(c.next,r).onUpdate(function(){var e=this;n.$$phase||n.$apply(function(){var t=Object.keys(e).reduce(function(n,t){var o=e[t],a=t.split("_"),r=a[0],i=a[1];return console.log(a),n[i]=n[i]||{},n[i][r]=o,n},{});console.log(t);var o=_.clone(n.data);Object.keys(t).forEach(function(n){var e=t[n];o[n].position=[e.x,e.y,e.z]}),n.data=o})}).onComplete(function(){l()}).interpolation(TWEEN.Interpolation.Bezier).easing(TWEEN.Easing.Linear.None).delay(250).start()}else t(l,i)}function a(n){requestAnimationFrame(a),TWEEN.update(n)}var r=2e3,i=500;n.loading=!0,n.data=[];var l=[];n.values={index:1},n.config={colortype:"variable",axis:!0,axisLength:500,streaming:!0,background:[.3,.3,.3],grid:!0,gridConfig:{lines:60,dim:500}},e.Pick().stats(function(e){l=Immutable.List(e.data),n.data=_.clone(l.get(0)),n.loading=!1}),n.play=function(){function e(t){if(console.log(t),t<l.count()-1){var a=_.clone(l.get(t)),r=_.clone(l.get(t+1));o(t,a,r,function(){e(t+1)})}else n.values.index=l.count()}e(0)},requestAnimationFrame(a)}]),angular.module("Application").controller("SliderCtrl",["$scope",function(n){function e(n){requestAnimationFrame(e),TWEEN.update(n)}var t={x:0,y:0,z:0};new TWEEN.Tween(t).to({x:100,y:50,z:70},1e4).onUpdate(function(){var e=this;n.$apply(function(){n.coords={x:e.x,y:e.y,z:e.z},console.log(n.coords)})}).start();requestAnimationFrame(e)}]),angular.module("Application").factory("ApiService",["$resource","$location",function(n,e){return{env:"prod",prod:{protocol:"https",host:"pickyourday.herokuapp.com",port:"",root:"api"},dev:{protocol:"http",host:"localhost",port:"5000",root:"api"},getApiPath:function(n){var e=this[this.env];return e.protocol+"://"+e.host+(""!==e.port?":"+e.port:"")+"/"+e.root+"/"+n},rest:function(e,t,o){var a=n(this.getApiPath(e),o||{},t||{});return a}}}]),angular.module("Application").factory("CompanyService",["ApiService",function(n){return{base:"company",Pick:function(){return n.rest(this.base+"/statsPicks",{stats:{method:"GET",params:{}}})}}}]),angular.module("Application").factory("AuthInterceptor",["$q","$location",function(n,e){return{request:function(n){n.headers=n.headers||{};var e=getJSONLocal("user"),e=getJSONLocal("user");return!n.headers.Authorization&&e&&(n.headers.Authorization=e.token),n},requestError:function(e){return n.reject(e)},response:function(e){return"ERROR"===e.data.status?n.reject(e):e||n.when(e)},responseError:function(t){return 403===t.status?(console.error("Error de acceso"),localStorage.user="",void e.path("/")):n.reject(t)}}}]),angular.module("Application").factory("OauthService",["ApiService",function(n){return{base:"oauth",login:function(){return n.rest(this.base,{Session:{method:"POST",params:{}}})},logout:function(){return n.rest(this.base+"/logout",{Session:{method:"GET",params:{}}})},role:function(){return n.rest(this.base+"/role/:role",{check:{method:"GET",params:{role:"@role"}}})}}}]),angular.module("Application").factory("RequestService",function(){return{ServerNotFound:ClosureMessage("Server Not Found"),NoRoleAuthorized:ClosureMessage("No Role Authorized")}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdXRpbHMuanMiLCJhcHBsaWNhdGlvbi5qcyIsInRlbXBsYXRlLWNhY2hlLmpzIiwiY29uZmlnL2Jvb3QuanMiLCJjb25maWcvZW52aXJvbm1lbnQuanMiLCJjb250cm9sbGVycy9hcHBsaWNhdGlvbl9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvbG9naW5fY29udHJvbGxlci5qcyIsImNvbnRyb2xsZXJzL25vcm1hbF9jb250cm9sbGVyLmpzIiwiY29udHJvbGxlcnMvcGxheWVyX2NvbnRyb2xsZXIuanMiLCJjb250cm9sbGVycy9zbGlkZXJfY29udHJvbGxlci5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvYXBpLnNlcnZpY2UuanMiLCJjb21wb25lbnRzL3NlcnZpY2VzL2NvbXBhbnlfc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvaW50ZXJjZXB0b3Jfc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvb2F1dGguc2VydmljZS5qcyIsImNvbXBvbmVudHMvc2VydmljZXMvcmVxdWVzdF9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbInNhdmVMb2NhbCIsImtleSIsImRhdGEiLCJsb2NhbFN0b3JhZ2UiLCJKU09OIiwic3RyaW5naWZ5IiwiZ2V0SlNPTkxvY2FsIiwicmVzdWx0Iiwic3RyX2pzb24iLCJ1bmRlZmluZWQiLCJwYXJzZSIsImUiLCJkZWxldGVMb2NhbCIsInJlbW92ZUl0ZW0iLCJDbG9zdXJlTWVzc2FnZSIsIm1lc3NhZ2UiLCJmbiIsImVtcHR5T3JVbmRlZmluZWQiLCJ2YWx1ZSIsIlJhbmRQb3NpdGlvbiIsInYiLCJyYW5nZSIsIm1pbiIsIm1heCIsIngiLCJjaGFuY2UiLCJmbG9hdGluZyIsInkiLCJ6IiwiUmFuZENvbG9yIiwicmFuZ2VDb2xvciIsImZpeGVkIiwiciIsImciLCJiIiwiUmFuZFNpemUiLCJzaXplIiwiUmFuZFJvdGF0aW9uIiwiTnVtYmVyIiwiYm9vbCIsImFuZ2xlIiwiaW50ZWdlciIsImF4aXMiLCJnZW5lcmF0ZSIsImNvdW50IiwiQXJyYXkiLCJhcHBseSIsIm1hcCIsImFwcCIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkdGVtcGxhdGVDYWNoZSIsInB1dCIsIiRyb290U2NvcGUiLCIkbWRUb2FzdCIsIiRzdGF0ZSIsInNob3dUb2FzdCIsIm1zZyIsInNob3ciLCJzaW1wbGUiLCJ0ZXh0Q29udGVudCIsInRoZW1lIiwiaGlkZURlbGF5IiwiZ28iLCJzdGF0ZSIsInBhcmFtcyIsImNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiJGh0dHBQcm92aWRlciIsIiRtZFRoZW1pbmdQcm92aWRlciIsInVybCIsIm9uRW50ZXIiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXIiLCJhYnN0cmFjdCIsInZpZXdzIiwiY29udGVudCIsIm90aGVyd2lzZSIsImludGVyY2VwdG9ycyIsInB1c2giLCJiYWNrZ3JvdW5kUGFsZXR0ZSIsImRlZmF1bHQiLCJodWUtMSIsImh1ZS0yIiwiaHVlLTMiLCJwcmltYXJ5UGFsZXR0ZSIsImFjY2VudFBhbGV0dGUiLCIkc2NvcGUiLCJPYXV0aFNlcnZpY2UiLCJvcGVuTWVudSIsIiRtZE9wZW5NZW51IiwiZXYiLCJvcmlnaW5hdG9yRXYiLCJsb2dvdXQiLCJTZXNzaW9uIiwiUmVxdWVzdFNlcnZpY2UiLCJ1c2VyIiwiZW1haWwiLCJwYXNzd29yZCIsImxvZ2luIiwiYXN5bmMiLCJ3YXRlcmZhbGwiLCJuZXh0IiwiaXNFbWFpbCIsImlzUGFzc3dvcmQiLCJyZXMiLCJlcnJvciIsIlNlcnZlck5vdEZvdW5kIiwicm9sZSIsImNoZWNrIiwiTm9Sb2xlQXV0aG9yaXplZCIsImVyciIsIkNvbXBhbnlTZXJ2aWNlIiwiJHRpbWVvdXQiLCJhbmltYXRlQ2FsZW5kYXIiLCJzdGVwIiwiYyIsIm4iLCJjYiIsImludGVyX2RhdGEiLCJyZWR1Y2UiLCJwcmV2IiwiaXRlbSIsImluZGV4IiwiY19wb3MiLCJwb3NpdGlvbiIsIm5fcG9zIiwiXyIsImlzRXF1YWwiLCJsZW5ndGgiLCJjdXJyZW50IiwidmFsdWVzIiwiY29uc29sZSIsImxvZyIsIlRXRUVOIiwiVHdlZW4iLCJ0byIsIlBMQVlFUl9USU1FIiwib25VcGRhdGUiLCJzZWxmIiwidGhpcyIsIiQkcGhhc2UiLCIkYXBwbHkiLCJpbnRlcl9hcnJheSIsIk9iamVjdCIsImtleXMiLCJzcGxpdCIsInBhcmFtIiwiY2xvbmVfZGF0YSIsImNsb25lIiwiZm9yRWFjaCIsIm9uQ29tcGxldGUiLCJpbnRlcnBvbGF0aW9uIiwiSW50ZXJwb2xhdGlvbiIsIkJlemllciIsImVhc2luZyIsIkVhc2luZyIsIkxpbmVhciIsIk5vbmUiLCJkZWxheSIsInN0YXJ0IiwiRU1QVFlfVElNRSIsIkludGVycG9sYXRpb25UaW1lIiwidGltZSIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInVwZGF0ZSIsImxvYWRpbmciLCJjYWxlbmRhciIsImNvbG9ydHlwZSIsImF4aXNMZW5ndGgiLCJzdHJlYW1pbmciLCJiYWNrZ3JvdW5kIiwiZ3JpZCIsImdyaWRDb25maWciLCJsaW5lcyIsImRpbSIsIlBpY2siLCJzdGF0cyIsIkltbXV0YWJsZSIsIkxpc3QiLCJnZXQiLCJwbGF5IiwiaXRlciIsImkiLCJhbmltYXRlIiwiY29vcmRzIiwiZmFjdG9yeSIsIiRyZXNvdXJjZSIsIiRsb2NhdGlvbiIsImVudiIsInByb2QiLCJwcm90b2NvbCIsImhvc3QiLCJwb3J0Iiwicm9vdCIsImRldiIsImdldEFwaVBhdGgiLCJwYXRoIiwiYXBpIiwicmVzdCIsIm1ldGhvZHMiLCJkZWZhdWx0UGFyYW1zIiwicmVzb3VyY2UiLCJBcGlTZXJ2aWNlIiwiYmFzZSIsIm1ldGhvZCIsIiRxIiwicmVxdWVzdCIsImhlYWRlcnMiLCJBdXRob3JpemF0aW9uIiwidG9rZW4iLCJyZXF1ZXN0RXJyb3IiLCJyZWplY3Rpb24iLCJyZWplY3QiLCJyZXNwb25zZSIsInN0YXR1cyIsIndoZW4iLCJyZXNwb25zZUVycm9yIl0sIm1hcHBpbmdzIjoi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QSxNQUFBK0YsR0FBQUosS0FBQTNELEtBQUFnRSxLQUFBLGVBQ0EvRixPQUFBZ0csT0FBQSxNQUFBN0ksUUFBQTRDLEtBQUEsaUJDbEJBN0QsUUFBQUMsT0FBQSxlQUNBMEksUUFBQSxpQkFBQSxXQUVBLE9BRUEvRSxlQUFBL0YsZUFBQSxvQkFFQWtHLGlCQUFBbEcsZUFBQSIsImZpbGUiOiJidW5kbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc2F2ZUxvY2FsKGtleSwgZGF0YSkge1xyXG4gICAgbG9jYWxTdG9yYWdlW2tleV0gPSBKU09OLnN0cmluZ2lmeShkYXRhKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0SlNPTkxvY2FsKGtleSkge1xyXG5cclxuICAgIHZhciByZXN1bHQgPSBudWxsO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgc3RyX2pzb24gPSBsb2NhbFN0b3JhZ2Vba2V5XTtcclxuXHJcbiAgICAgICAgaWYgKHN0cl9qc29uIT09dW5kZWZpbmVkKSB7XHJcblxyXG4gICAgICAgICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHN0cl9qc29uKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfSBjYXRjaCAoZSkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG59XHJcblxyXG5mdW5jdGlvbiBkZWxldGVMb2NhbChrZXkpIHtcclxuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGtleSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIENsb3N1cmVNZXNzYWdlKG1lc3NhZ2Upe1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uKGZuKXtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgZm4obWVzc2FnZSk7XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVtcHR5T3JVbmRlZmluZWQodmFsdWUpe1xyXG4gICAgcmV0dXJuIHZhbHVlPT12b2lkIDAgfHwgdmFsdWU9PT1cIlwiO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gUmFuZFBvc2l0aW9uKHYpIHtcclxuICAgIHZhciByYW5nZSA9IHYgfHwgeyBtaW46IDAsIG1heDogMTAwIH07XHJcbiAgICB2YXIgeCA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZSk7XHJcbiAgICB2YXIgeSA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZSk7XHJcbiAgICB2YXIgeiA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZSk7XHJcbiAgICByZXR1cm4gW3gsIHksIHpdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBSYW5kQ29sb3Iodikge1xyXG4gICAgdmFyIHJhbmdlQ29sb3IgPSB2IHx8IHsgbWluOiAwLCBtYXg6IDEsIGZpeGVkOiAyIH07XHJcbiAgICB2YXIgciA9IGNoYW5jZS5mbG9hdGluZyhyYW5nZUNvbG9yKTtcclxuICAgIHZhciBnID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlQ29sb3IpO1xyXG4gICAgdmFyIGIgPSBjaGFuY2UuZmxvYXRpbmcocmFuZ2VDb2xvcik7XHJcbiAgICByZXR1cm4gW3IsIGcsIGIsIDFdO1xyXG59XHJcblxyXG5mdW5jdGlvbiBSYW5kU2l6ZSh2KSB7XHJcbiAgICB2YXIgcmFuZ2UgPSB2IHx8IHsgbWluOiAwLjEsIG1heDogMiwgZml4ZWQ6IDEgfTtcclxuICAgIHZhciBzaXplID0gY2hhbmNlLmZsb2F0aW5nKHJhbmdlKTtcclxuICAgIHJldHVybiBbc2l6ZSwgc2l6ZSwgc2l6ZV07XHJcbn1cclxuXHJcblxyXG5mdW5jdGlvbiBSYW5kUm90YXRpb24odil7XHJcbiAgICB2YXIgcmFuZ2UgPSB2IHx8IHsgbWluOiAwLCBtYXg6IDM2MH07XHJcbiAgICB2YXIgeD1OdW1iZXIoY2hhbmNlLmJvb2woKSk7XHJcbiAgICB2YXIgeT1OdW1iZXIoY2hhbmNlLmJvb2woKSk7XHJcbiAgICB2YXIgej1OdW1iZXIoY2hhbmNlLmJvb2woKSk7XHJcbiAgICByZXR1cm4gIHtcclxuICAgICAgICBhbmdsZTpjaGFuY2UuaW50ZWdlcih7IG1pbjogMCwgbWF4OiAzNjB9KSxcclxuICAgICAgICBheGlzOlt4LHksel1cclxuICAgIH1cclxufVxyXG5cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlKGZuKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGNvdW50ID0gY2hhbmNlLmludGVnZXIoeyBtaW46IDAsIG1heDogMTAwIH0pO1xyXG4gICAgICAgIHJldHVybiBBcnJheS5hcHBseSgwLCBBcnJheShjb3VudCkpLm1hcChmbik7XHJcbiAgICB9O1xyXG59IiwidmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFsndWkucm91dGVyJywgXCJuZ1Jlc291cmNlXCIsJ25nQW5pbWF0ZScsICduZ01hdGVyaWFsJywgJ2FsZXhhbmRyYSddKTsiLCIoZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdmlld3MvbWFpbi5odG1sJyxcbiAgICAnXFxuJyArXG4gICAgJzxtZC10b29sYmFyIGNsYXNzPVwibWQtYWNjZW50IG1kLXdoaXRlZnJhbWUtMWRwXCI+XFxuJyArXG4gICAgJyAgICA8ZGl2IGNsYXNzPVwibWQtdG9vbGJhci10b29sc1wiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgPG1kLW1lbnUgZmxleD1cIjVcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwiVHlwZSBTdGF0c1wiIGNsYXNzPVwibWQtaWNvbi1idXR0b25cIiBuZy1jbGljaz1cIm9wZW5NZW51KCRtZE9wZW5NZW51LCAkZXZlbnQpXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtaWNvbiBtZC1tZW51LW9yaWdpbiBtZC1mb250LWljb249XCJtZGktY2hhcnQtYXJlYXNwbGluZVwiIGNsYXNzPVwibWRpXCI+PC9tZC1pY29uPlxcbicgK1xuICAgICcgICAgICAgICAgICA8L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPG1kLW1lbnUtY29udGVudCB3aWR0aD1cIjRcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxtZC1tZW51LWl0ZW0+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPG1kLWJ1dHRvbiB1aS1zcmVmPVwiYXBwLm5vcm1hbFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICA8bWQtaWNvbiBtZC1mb250LWljb249XCJtZGktY2hhcnQtYnViYmxlXCIgY2xhc3M9XCJtZGlcIj48L21kLWljb24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIE5vcm1hbFxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDwvbWQtYnV0dG9uPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPC9tZC1tZW51LWl0ZW0+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtbWVudS1pdGVtPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgIDxtZC1idXR0b24gIHVpLXNyZWY9XCJhcHAuc2xpZGVyXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgICAgIDxtZC1pY29uIG1kLWZvbnQtaWNvbj1cIm1kaS1jbG9jay1zdGFydFwiIGNsYXNzPVwibWRpXCI+PC9tZC1pY29uPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgICAgICAgICBTbGlkZXJcXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICA8L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDwvbWQtbWVudS1pdGVtPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPG1kLW1lbnUtZGl2aWRlcj48L21kLW1lbnUtZGl2aWRlcj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxtZC1tZW51LWl0ZW0+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPG1kLWJ1dHRvbiAgdWktc3JlZj1cImFwcC5wbGF5ZXJcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICAgICAgPG1kLWljb24gbWQtZm9udC1pY29uPVwibWRpLXBsYXktYm94LW91dGxpbmVcIiBjbGFzcz1cIm1kaVwiPjwvbWQtaWNvbj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgICAgICAgICAgUGxheWVyXFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICAgICAgPC9tZC1idXR0b24+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L21kLW1lbnUtaXRlbT5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1tZW51LWNvbnRlbnQ+XFxuJyArXG4gICAgJyAgICAgICAgPC9tZC1tZW51PlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICA8aDI+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxzcGFuPlBpY2t5b3VyZGF5IDNEPC9zcGFuPlxcbicgK1xuICAgICcgICAgICAgIDwvaDI+XFxuJyArXG4gICAgJyAgICAgICAgPHNwYW4gZmxleD48L3NwYW4+XFxuJyArXG4gICAgJyAgICAgICAgPG1kLWJ1dHRvbiBhcmlhLWxhYmVsPVwibG9nb3V0XCIgY2xhc3M9XCJtZC1pY29uLWJ1dHRvblwiIHN0eWxlPVwibWFyZ2luLXJpZ2h0OiAwcHg7XCIgbmctY2xpY2s9XCJsb2dvdXQoKVwiPlxcbicgK1xuICAgICcgICAgICAgICAgICA8bWQtaWNvbiBtZC1mb250LWljb249XCJtZGktcG93ZXJcIiBjbGFzcz1cIm1kaVwiPjwvbWQtaWNvbj5cXG4nICtcbiAgICAnICAgICAgICA8L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnICAgIDwvZGl2PlxcbicgK1xuICAgICc8L21kLXRvb2xiYXI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnPGRpdiB1aS12aWV3PVwiY29udGVudFwiPjwvZGl2PicpO1xufV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKG1vZHVsZSkge1xudHJ5IHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJyk7XG59IGNhdGNoIChlKSB7XG4gIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFtdKTtcbn1cbm1vZHVsZS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnL3ZpZXdzL2xvZ2luL21haW4uaHRtbCcsXG4gICAgJzxkaXYgbGF5b3V0PVwiY29sdW1uXCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIGNlbnRlclwiPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgPG1kLWNhcmQ+XFxuJyArXG4gICAgJyAgICAgICAgPG1kLWNhcmQtdGl0bGU+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1jYXJkLXRpdGxlLXRleHQ+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWhlYWRsaW5lXCI+UGlja3lvdXJkYXkgM0Q8L3NwYW4+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgICAgICA8L21kLWNhcmQtdGl0bGUtdGV4dD5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgPC9tZC1jYXJkLXRpdGxlPlxcbicgK1xuICAgICcgICAgICAgIDxtZC1jYXJkLWNvbnRlbnQgbGF5b3V0PVwiY29sdW1uXCI+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICAgICAgPG1kLWlucHV0LWNvbnRhaW5lciBjbGFzcz1cIm1kLXByaW1hcnkgbWQtcmFpc2VkIG1kLWh1ZS0yXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bGFiZWw+RW1haWw8L2xhYmVsPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGlucHV0IG5nLW1vZGVsPVwidXNlci5lbWFpbFwiIHR5cGU9XCJlbWFpbFwiPlxcbicgK1xuICAgICcgICAgICAgICAgICA8L21kLWlucHV0LWNvbnRhaW5lcj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1pbnB1dC1jb250YWluZXIgY2xhc3M9XCJtZC1wcmltYXJ5IG1kLXJhaXNlZCBtZC1odWUtMlwiPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgPGxhYmVsPlBhc3N3b3JkPC9sYWJlbD5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIDxpbnB1dCBuZy1tb2RlbD1cInVzZXIucGFzc3dvcmRcIiB0eXBlPVwicGFzc3dvcmRcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1pbnB1dC1jb250YWluZXI+XFxuJyArXG4gICAgJyAgICAgICAgPC9tZC1jYXJkLWNvbnRlbnQ+XFxuJyArXG4gICAgJyAgICAgICAgPG1kLWNhcmQtYWN0aW9ucyBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1idXR0b24gY2xhc3M9XCJtZC1wcmltYXJ5ICBtZC1yYWlzZWQgbWQtaHVlLTJcIiBuZy1jbGljaz1cImxvZ2luKClcIj5Mb2dpbjwvbWQtYnV0dG9uPlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICA8L21kLWNhcmQtYWN0aW9ucz5cXG4nICtcbiAgICAnICAgIDwvbWQtY2FyZD5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICc8L2Rpdj4nKTtcbn1dKTtcbn0pKCk7XG5cbihmdW5jdGlvbihtb2R1bGUpIHtcbnRyeSB7XG4gIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpO1xufSBjYXRjaCAoZSkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nLCBbXSk7XG59XG5tb2R1bGUucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbigkdGVtcGxhdGVDYWNoZSkge1xuICAkdGVtcGxhdGVDYWNoZS5wdXQoJy92aWV3cy9ub3JtYWwvbWFpbi5odG1sJyxcbiAgICAnPGRpdj5Ob3JtYWw8L2Rpdj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJycpO1xufV0pO1xufSkoKTtcblxuKGZ1bmN0aW9uKG1vZHVsZSkge1xudHJ5IHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJyk7XG59IGNhdGNoIChlKSB7XG4gIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicsIFtdKTtcbn1cbm1vZHVsZS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7XG4gICR0ZW1wbGF0ZUNhY2hlLnB1dCgnL3ZpZXdzL3BsYXllci9tYWluLmh0bWwnLFxuICAgICc8bWQtcHJvZ3Jlc3MtbGluZWFyIG1kLW1vZGU9XCJpbmRldGVybWluYXRlXCIgbmctaWY9XCJsb2FkaW5nXCI+PC9tZC1wcm9ncmVzcy1saW5lYXI+XFxuJyArXG4gICAgJzxkaXYgY2xhc3M9XCJwbGF5ZXItY29udGVudFwiIGxheW91dD1cInJvd1wiPlxcbicgK1xuICAgICcgICAgPGNhbnZhcyBhbGV4YW5kcmEtdmlldyBkYXRhLWlkPVwidmlld18xXCIgYWxleGFuZHJhLWNvbmZpZz1cImNvbmZpZ1wiIGFsZXhhbmRyYS1zb3VyY2U9XCJkYXRhXCIgd2lkdGg9XCI4MDBcIiBoZWlnaHQ9XCI2MDBcIj48L2NhbnZhcz5cXG4nICtcbiAgICAnICAgIDxkaXYgZmxleD1cIjM1XCIgbGF5b3V0PVwiY29sdW1uXCIgbGF5b3V0LWFsaWduPVwiY2VudGVyIHN0cmVjaFwiPlxcbicgK1xuICAgICcgICAgICAgIDxkaXYgZmxleCBsYXlvdXQ9XCJyb3dcIiBsYXlvdXQtYWxpZ249XCJjZW50ZXIgY2VudGVyXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1idXR0b24gbmctY2xpY2s9XCJwbGF5KClcIiBuZy1pZj1cIiFsb2FkaW5nXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtaWNvbiBtZC1mb250LWljb249XCJtZGktcGxheVwiIGNsYXNzPVwibWRpXCI+PC9tZC1pY29uPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICAgUGxheVxcbicgK1xuICAgICcgICAgICAgICAgICA8L21kLWJ1dHRvbj5cXG4nICtcbiAgICAnICAgICAgICA8L2Rpdj5cXG4nICtcbiAgICAnXFxuJyArXG4gICAgJyAgICAgICAgPGRpdiBmbGV4PlxcbicgK1xuICAgICcgICAgICAgICAgICA8ZGl2IG5nLXJlcGVhdD1cInZtIGluIGRhdGFcIj5cXG4nICtcbiAgICAnICAgICAgICAgICAgICAgIHt7dm0ucG9zaXRpb259fVxcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgICAgICAgICAgPC9kaXY+XFxuJyArXG4gICAgJyAgICAgICAgPC9kaXY+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICcgICAgICAgIDxkaXY+XFxuJyArXG4gICAgJyAgICAgICAgICAgIDxtZC1zbGlkZXItY29udGFpbmVyPlxcbicgK1xuICAgICcgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm1kLWJvZHktMVwiPnt7dmFsdWVzLmluZGV4fX08L3NwYW4+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8bWQtc2xpZGVyIGNsYXNzPVwibWQtcHJpbWFyeVwiIG1kLWRpc2NyZXRlIHN0ZXA9XCIxXCIgbWluPVwiMVwiIG1heD1cIjMwXCIgYXJpYS1sYWJlbD1cInJhdGluZ1wiIG5nLXNob3c9XCIhbG9hZGluZ1wiIG5nLW1vZGVsPVwidmFsdWVzLmluZGV4XCIgbmctZGlzYWJsZWQ9XCJ0cnVlXCI+XFxuJyArXG4gICAgJyAgICAgICAgICAgICAgICA8L21kLXNsaWRlcj5cXG4nICtcbiAgICAnICAgICAgICAgICAgPC9tZC1zbGlkZXItY29udGFpbmVyPlxcbicgK1xuICAgICcgICAgICAgIDwvZGl2PlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnXFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnICAgIDwvZGl2PlxcbicgK1xuICAgICdcXG4nICtcbiAgICAnPC9kaXY+XFxuJyArXG4gICAgJ1xcbicgK1xuICAgICdcXG4nICtcbiAgICAnJyk7XG59XSk7XG59KSgpO1xuXG4oZnVuY3Rpb24obW9kdWxlKSB7XG50cnkge1xuICBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKTtcbn0gY2F0Y2ggKGUpIHtcbiAgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJywgW10pO1xufVxubW9kdWxlLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHtcbiAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdmlld3Mvc2xpZGVyL21haW4uaHRtbCcsXG4gICAgJzxkaXY+U2xpZGVyPC9kaXY+XFxuJyArXG4gICAgJ3t7Y29vcmRzLnh9fSwge3tjb29yZHMueX19LCB7e2Nvb3Jkcy56fX0nKTtcbn1dKTtcbn0pKCk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKVxyXG4gICAgLnJ1bihmdW5jdGlvbigkcm9vdFNjb3BlLCAgJG1kVG9hc3QsICRzdGF0ZSl7XHJcblxyXG4gICAgJHJvb3RTY29wZS5zaG93VG9hc3QgPSBmdW5jdGlvbihtc2cpIHtcclxuICAgICAgXHJcbiAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcclxuICAgICAgICAgICAgLnRleHRDb250ZW50KG1zZylcclxuICAgICAgICAgICAgLnRoZW1lKFwicGljay10aGVtZVwiKVxyXG4gICAgICAgICAgICAuaGlkZURlbGF5KDMwMDApXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgICAkcm9vdFNjb3BlLmdvID0gZnVuY3Rpb24gKHN0YXRlLCBwYXJhbXMpIHtcclxuICAgICAgICAkc3RhdGUuZ28oc3RhdGUsIHBhcmFtcyk7XHJcbiAgICB9O1xyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGh0dHBQcm92aWRlciwgICRtZFRoZW1pbmdQcm92aWRlcil7XHJcblxyXG5cclxuICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgLnN0YXRlKFwibG9naW5cIiwge1xyXG4gICAgICAgIHVybDogXCIvbG9naW5cIixcclxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICBpZiAoZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJhcHAucGxheWVyXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9sb2dpbi9tYWluLmh0bWwnLFxyXG4gICAgICAgIGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnICAgICAgXHJcblxyXG4gICAgfSlcclxuICAgICAgICAuc3RhdGUoXCJhcHBcIiwge1xyXG4gICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgIG9uRW50ZXI6IGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgICAgIGlmICghZ2V0SlNPTkxvY2FsKFwidXNlclwiKSkge1xyXG5cclxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuZ28oXCJsb2dpblwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6ICcvdmlld3MvbWFpbi5odG1sJyxcclxuICAgICAgICBjb250cm9sbGVyOiAnQXBwQ3RybCcsXHJcbiAgICAgICAgYWJzdHJhY3Q6dHJ1ZVxyXG5cclxuICAgIH0pXHJcbiAgICAgICAgLnN0YXRlKFwiYXBwLm5vcm1hbFwiLCB7XHJcbiAgICAgICAgdXJsOiAnbm9ybWFsJyxcclxuICAgICAgICBvbkVudGVyOiBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG4gICAgICAgICAgICBpZiAoIWdldEpTT05Mb2NhbChcInVzZXJcIikpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwibG9naW5cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL3ZpZXdzL25vcm1hbC9tYWluLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ05vcm1hbEN0cmwnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9ICBcclxuICAgIH0pXHJcbiAgICBcclxuICAgIC5zdGF0ZShcImFwcC5zbGlkZXJcIiwge1xyXG4gICAgICAgIHVybDogJ3NsaWRlcicsXHJcbiAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgaWYgKCFnZXRKU09OTG9jYWwoXCJ1c2VyXCIpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImxvZ2luXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICBjb250ZW50OiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9zbGlkZXIvbWFpbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdTbGlkZXJDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgXHJcbiAgICB9KVxyXG4gICAgIC5zdGF0ZShcImFwcC5wbGF5ZXJcIiwge1xyXG4gICAgICAgIHVybDogJ3BsYXllcicsXHJcbiAgICAgICAgb25FbnRlcjogZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuICAgICAgICAgICAgaWYgKCFnZXRKU09OTG9jYWwoXCJ1c2VyXCIpKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS5nbyhcImxvZ2luXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICBjb250ZW50OiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy92aWV3cy9wbGF5ZXIvbWFpbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQbGF5ZXJDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgXHJcbiAgICB9KVxyXG5cclxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoXCIvbG9naW5cIik7XHJcblxyXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aEludGVyY2VwdG9yJyk7XHJcblxyXG4gICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAuYmFja2dyb3VuZFBhbGV0dGUoJ3RlYWwnLCB7XHJcbiAgICAgICdkZWZhdWx0JzogJzUwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAnaHVlLTEnOiAnMTAwJywgLy8gdXNlIHNoYWRlIDEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0xPC9jb2RlPiBjbGFzc1xyXG4gICAgICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xyXG4gICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgIH0pXHJcbiAgICAucHJpbWFyeVBhbGV0dGUoJ2xpbWUnLCB7XHJcbiAgICAgICdkZWZhdWx0JzogJzQwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAnaHVlLTEnOiAnMTAwJywgLy8gdXNlIHNoYWRlIDEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0xPC9jb2RlPiBjbGFzc1xyXG4gICAgICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xyXG4gICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgIH0pXHJcbiAgICAvLyBJZiB5b3Ugc3BlY2lmeSBsZXNzIHRoYW4gYWxsIG9mIHRoZSBrZXlzLCBpdCB3aWxsIGluaGVyaXQgZnJvbSB0aGVcclxuICAgIC8vIGRlZmF1bHQgc2hhZGVzXHJcbiAgICAuYWNjZW50UGFsZXR0ZSgndGVhbCcsIHtcclxuICAgICAgJ2RlZmF1bHQnOiAnNTAwJyAvLyB1c2Ugc2hhZGUgMjAwIGZvciBkZWZhdWx0LCBhbmQga2VlcCBhbGwgb3RoZXIgc2hhZGVzIHRoZSBzYW1lXHJcbiAgICB9KTtcclxuXHJcblxyXG5cclxufSk7XHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0FwcEN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIE9hdXRoU2VydmljZSl7XHJcbiAgICBcclxuICAgIFxyXG4gICAgJHNjb3BlLm9wZW5NZW51ID0gZnVuY3Rpb24oJG1kT3Blbk1lbnUsIGV2KSB7XHJcbiAgICAgIG9yaWdpbmF0b3JFdiA9IGV2O1xyXG4gICAgICAkbWRPcGVuTWVudShldik7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICBcclxuICAgICRzY29wZS5sb2dvdXQ9ZnVuY3Rpb24oKXtcclxuICAgICAgICBPYXV0aFNlcnZpY2UuIGxvZ291dCgpLlNlc3Npb24oZnVuY3Rpb24oKXtcclxuXHRcdCBkZWxldGVMb2NhbChcInVzZXJcIik7XHJcbiAgICAgICAgJHJvb3RTY29wZS5nbyhcImxvZ2luXCIpOyAgIFxyXG5cdH0sIGZ1bmN0aW9uKCl7fSk7XHJcbiAgICB9XHJcbiAgICBcclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsIE9hdXRoU2VydmljZSwgUmVxdWVzdFNlcnZpY2Upe1xyXG4gICAgXHJcblxyXG4gICAgXHJcbiAgICAkc2NvcGUudXNlciA9IHtlbWFpbDpcIlwiLCBwYXNzd29yZDpcIlwifTtcclxuICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBhc3luYy53YXRlcmZhbGwoW1xyXG5cclxuICAgICAgICAgICAgZnVuY3Rpb24gdmFsaWRhdGUobmV4dCl7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNFbWFpbD1lbXB0eU9yVW5kZWZpbmVkKCRzY29wZS51c2VyLmVtYWlsKTtcclxuICAgICAgICAgICAgICAgIHZhciBpc1Bhc3N3b3JkPWVtcHR5T3JVbmRlZmluZWQoJHNjb3BlLnVzZXIucGFzc3dvcmQpO1xyXG4gICAgICAgICAgICAgICAgaWYoaXNFbWFpbCB8fCBpc1Bhc3N3b3JkKXtcclxuICAgICAgICAgICAgICAgICAgICBpZihpc0VtYWlsKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChcIkVtYWlsIEVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihpc1Bhc3N3b3JkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dChcIlBhc3N3b3JkIEVtcHR5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbiBsb2dpbihuZXh0KXtcclxuXHJcbiAgICAgICAgICAgICAgICBPYXV0aFNlcnZpY2UubG9naW4oKS5TZXNzaW9uKCRzY29wZS51c2VyLCBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlcy5lcnJvcilyZXR1cm4gbmV4dChyZXMuZXJyb3IpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBuZXh0KG51bGwsIHJlcy5kYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LCBSZXF1ZXN0U2VydmljZS5TZXJ2ZXJOb3RGb3VuZChuZXh0KSk7XHJcblxyXG4gICAgICAgICAgICB9LCBcclxuICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tSb2xlKHVzZXIsIG5leHQpe1xyXG4gICAgICAgICAgICAgICAgT2F1dGhTZXJ2aWNlLnJvbGUoKS5jaGVjayh7cm9sZTp1c2VyLnJvbGV9LCBmdW5jdGlvbihyZXMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHJlcy5lcnJvcilyZXR1cm4gbmV4dChyZXMuZXJyb3IpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihyZXMuZGF0YT09Mil7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0KG51bGwsIHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBSZXF1ZXN0U2VydmljZS5Ob1JvbGVBdXRob3JpemVkKG5leHQpKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0sIFJlcXVlc3RTZXJ2aWNlLlNlcnZlck5vdEZvdW5kKG5leHQpKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcblxyXG4gICAgICAgIF0sIGZ1bmN0aW9uKGVyciwgdXNlcil7XHJcbiAgICAgICAgICAgIGlmKGVycil7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS5zaG93VG9hc3QoZXJyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzYXZlTG9jYWwoXCJ1c2VyXCIsIHVzZXIpO1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmdvKFwiYXBwLm5vcm1hbFwiKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgXHJcbiAgICBcclxuICAgIFxyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ05vcm1hbEN0cmwnLCBmdW5jdGlvbigpe1xyXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1BsYXllckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIENvbXBhbnlTZXJ2aWNlLCAkdGltZW91dCl7XHJcblxyXG4gICAgdmFyIFBMQVlFUl9USU1FPTIwMDA7XHJcbiAgICB2YXIgRU1QVFlfVElNRT01MDA7XHJcblxyXG4gICAgJHNjb3BlLmxvYWRpbmc9dHJ1ZTtcclxuICAgICRzY29wZS5kYXRhPVtdO1xyXG4gICAgdmFyIGNhbGVuZGFyPVtdO1xyXG4gICAgJHNjb3BlLnZhbHVlcz17XHJcbiAgICAgICAgaW5kZXg6MX07XHJcblxyXG4gICAgJHNjb3BlLmNvbmZpZz17XHJcbiAgICAgICAgY29sb3J0eXBlOlwidmFyaWFibGVcIixcclxuICAgICAgICBheGlzOnRydWUsXHJcbiAgICAgICAgYXhpc0xlbmd0aDo1MDAsXHJcbiAgICAgICAgc3RyZWFtaW5nOnRydWUsXHJcbiAgICAgICAgYmFja2dyb3VuZDpbMC4zLDAuMywwLjNdLFxyXG4gICAgICAgIGdyaWQ6dHJ1ZSxcclxuICAgICAgICBncmlkQ29uZmlnOntcclxuICAgICAgICAgICAgbGluZXM6NjAsXHJcbiAgICAgICAgICAgIGRpbTo1MDBcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxuXHJcblxyXG4gICAgQ29tcGFueVNlcnZpY2UuUGljaygpLnN0YXRzKGZ1bmN0aW9uKHJlcyl7XHJcbiAgICAgICAgY2FsZW5kYXI9SW1tdXRhYmxlLkxpc3QocmVzLmRhdGEpO1xyXG4gICAgICAgICRzY29wZS5kYXRhPV8uY2xvbmUoY2FsZW5kYXIuZ2V0KDApKTtcclxuICAgICAgICAkc2NvcGUubG9hZGluZz1mYWxzZTsgXHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgZnVuY3Rpb24gYW5pbWF0ZUNhbGVuZGFyKHN0ZXAsYywgbiwgY2Ipe1xyXG5cclxuICAgICAgICB2YXIgaW50ZXJfZGF0YT1jLnJlZHVjZShmdW5jdGlvbihwcmV2LGl0ZW0sIGluZGV4KXtcclxuICAgICAgICAgICAgdmFyIGNfcG9zPWl0ZW0ucG9zaXRpb247XHJcbiAgICAgICAgICAgIHZhciBuX3Bvcz1uW2luZGV4XS5wb3NpdGlvbjtcclxuXHJcblxyXG4gICAgICAgICAgICBpZighXy5pc0VxdWFsKGNfcG9zLCBuX3Bvcykpe1xyXG4gICAgICAgICAgICAgICAgcHJldi5sZW5ndGgrKztcclxuICAgICAgICAgICAgICAgIHByZXYuY3VycmVudFtcInhfXCIraW5kZXhdPWNfcG9zWzBdO1xyXG4gICAgICAgICAgICAgICAgcHJldi5jdXJyZW50W1wieV9cIitpbmRleF09Y19wb3NbMV07XHJcbiAgICAgICAgICAgICAgICBwcmV2LmN1cnJlbnRbXCJ6X1wiK2luZGV4XT1jX3Bvc1syXTtcclxuXHJcbiAgICAgICAgICAgICAgICBwcmV2Lm5leHRbXCJ4X1wiK2luZGV4XT1uX3Bvc1swXTtcclxuICAgICAgICAgICAgICAgIHByZXYubmV4dFtcInlfXCIraW5kZXhdPW5fcG9zWzFdO1xyXG4gICAgICAgICAgICAgICAgcHJldi5uZXh0W1wiel9cIitpbmRleF09bl9wb3NbMl07XHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHByZXY7XHJcblxyXG4gICAgICAgIH0sIHtcclxuICAgICAgICAgICAgY3VycmVudDp7fSxcclxuICAgICAgICAgICAgbmV4dDp7fSxcclxuICAgICAgICAgICAgbGVuZ3RoOjBcclxuICAgICAgICB9KTtcclxuICAgICAgICAkc2NvcGUudmFsdWVzLmluZGV4PXN0ZXArMTtcclxuICAgICAgICBjb25zb2xlLmxvZyhpbnRlcl9kYXRhKTtcclxuXHJcblxyXG5cclxuICAgICAgICBpZihpbnRlcl9kYXRhLmxlbmd0aD4wKXtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgdmFyIHR3ZWVuID0gbmV3IFRXRUVOLlR3ZWVuKGludGVyX2RhdGEuY3VycmVudClcclxuICAgICAgICAgICAgLnRvKGludGVyX2RhdGEubmV4dCwgUExBWUVSX1RJTUUpXHJcbiAgICAgICAgICAgIC5vblVwZGF0ZShmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgc2VsZj10aGlzO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmKCEkc2NvcGUuJCRwaGFzZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpeyBcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW50ZXJfYXJyYXk9T2JqZWN0LmtleXMoc2VsZikucmVkdWNlKGZ1bmN0aW9uKHByZXYsIGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlPXNlbGZbaXRlbV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5cz1pdGVtLnNwbGl0KFwiX1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbT1rZXlzWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4PWtleXNbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhrZXlzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2W2luZGV4XT1wcmV2W2luZGV4XXx8e31cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmV2W2luZGV4XVtwYXJhbV09dmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJldjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0se30pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaW50ZXJfYXJyYXkpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjbG9uZV9kYXRhPV8uY2xvbmUoJHNjb3BlLmRhdGEpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGludGVyX2FycmF5KS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlPWludGVyX2FycmF5W2l0ZW1dO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb25lX2RhdGFbaXRlbV0ucG9zaXRpb249W3ZhbHVlLngsIHZhbHVlLnksIHZhbHVlLnpdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRhdGE9Y2xvbmVfZGF0YTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm9uQ29tcGxldGUoZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICBjYigpO1xyXG4gICAgICAgICAgICB9KS5cclxuICAgICAgICAgICAgaW50ZXJwb2xhdGlvbiggVFdFRU4uSW50ZXJwb2xhdGlvbi5CZXppZXIgKS5lYXNpbmcoIFRXRUVOLkVhc2luZy5MaW5lYXIuTm9uZSApLmRlbGF5KCAyNTAgKVxyXG4gICAgICAgICAgICAuc3RhcnQoKVxyXG5cclxuXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoY2IsIEVNUFRZX1RJTUUpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG5cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcblxyXG4gICAgJHNjb3BlLnBsYXk9ZnVuY3Rpb24oKXtcclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGl0ZXIoaSl7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGkpO1xyXG5cclxuICAgICAgICAgICAgaWYoaTxjYWxlbmRhci5jb3VudCgpLTEpe1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1cnJlbnQ9Xy5jbG9uZShjYWxlbmRhci5nZXQoaSkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIG5leHQ9Xy5jbG9uZShjYWxlbmRhci5nZXQoaSsxKSk7XHJcbiAgICAgICAgICAgICAgICBhbmltYXRlQ2FsZW5kYXIoaSwgY3VycmVudCwgbmV4dCwgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBpdGVyKGkrMSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnZhbHVlcy5pbmRleD1jYWxlbmRhci5jb3VudCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaXRlcigwKTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShJbnRlcnBvbGF0aW9uVGltZSk7XHJcblxyXG5cclxuICAgIGZ1bmN0aW9uIEludGVycG9sYXRpb25UaW1lKHRpbWUpIHtcclxuXHJcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKEludGVycG9sYXRpb25UaW1lKTtcclxuICAgICAgICBUV0VFTi51cGRhdGUodGltZSk7XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG5cclxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ0FwcGxpY2F0aW9uJylcclxuICAgIC5jb250cm9sbGVyKCdTbGlkZXJDdHJsJywgZnVuY3Rpb24oJHNjb3BlKXtcclxuICAgIFxyXG4gIHZhciBjb29yZHMgPSB7IHg6IDAsIHk6IDAsIHo6MCB9O1xyXG5cclxuICAgIHZhciB0d2VlbiA9IG5ldyBUV0VFTi5Ud2Vlbihjb29yZHMpXHJcbiAgICAudG8oeyB4OiAxMDAsIHk6IDUwLCB6OjcwIH0sIDEwMDAwKVxyXG4gICAgLm9uVXBkYXRlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBzZWxmPXRoaXM7XHJcbiAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgJHNjb3BlLmNvb3Jkcz17eDpzZWxmLngsIHk6c2VsZi55LCB6OnNlbGYuen07XHJcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAkc2NvcGUuY29vcmRzKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgXHJcblxyXG4gICAgfSlcclxuICAgIC5zdGFydCgpXHJcblxyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xyXG5cdFxyXG5cclxuICAgIGZ1bmN0aW9uIGFuaW1hdGUodGltZSkge1xyXG4gICAgICAgIFxyXG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XHJcbiAgICAgICAgICAgIFRXRUVOLnVwZGF0ZSh0aW1lKTtcclxuICAgICAgICBcclxuXHJcbiAgICB9XHJcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuZmFjdG9yeShcIkFwaVNlcnZpY2VcIiwgZnVuY3Rpb24oJHJlc291cmNlLCAkbG9jYXRpb24pe1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgLy9lbnY6JGxvY2F0aW9uLmFic1VybCgpLmluZGV4T2YoXCJsb2NhbGhvc3RcIik9PS0xP1wicHJvZFwiOlwiZGV2XCIsXHJcbiAgICAgICAgZW52OlwicHJvZFwiLFxyXG4gICAgICAgIHByb2Q6e1xyXG4gICAgICAgICAgICBwcm90b2NvbDpcImh0dHBzXCIsXHJcbiAgICAgICAgICAgIGhvc3Q6XCJwaWNreW91cmRheS5oZXJva3VhcHAuY29tXCIsXHJcbiAgICAgICAgICAgIHBvcnQ6XCJcIixcclxuICAgICAgICAgICAgcm9vdDpcImFwaVwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBkZXY6e1xyXG4gICAgICAgICAgICBwcm90b2NvbDpcImh0dHBcIixcclxuICAgICAgICAgICAgaG9zdDpcImxvY2FsaG9zdFwiLFxyXG4gICAgICAgICAgICBwb3J0OlwiNTAwMFwiLFxyXG4gICAgICAgICAgICByb290OlwiYXBpXCJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBnZXRBcGlQYXRoOmZ1bmN0aW9uKHBhdGgpe1xyXG4gICAgICAgICAgICB2YXIgYXBpPXRoaXNbdGhpcy5lbnZdO1xyXG4gICAgICAgICAgICByZXR1cm4gYXBpLnByb3RvY29sK1wiOi8vXCIrYXBpLmhvc3QrKGFwaS5wb3J0IT09XCJcIj8oXCI6XCIrYXBpLnBvcnQpOlwiXCIpK1wiL1wiK2FwaS5yb290K1wiL1wiK3BhdGg7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcmVzdDpmdW5jdGlvbihwYXRoLCBtZXRob2RzLCBkZWZhdWx0UGFyYW1zKXtcclxuICAgICAgICAgICAgdmFyIHJlc291cmNlPSRyZXNvdXJjZShcclxuICAgICAgICAgICAgICAgIHRoaXMuZ2V0QXBpUGF0aChwYXRoKSxcclxuICAgICAgICAgICAgICAgIGRlZmF1bHRQYXJhbXMgfHwge30sXHJcbiAgICAgICAgICAgICAgICBtZXRob2RzIHx8IHt9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXNvdXJjZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KTtcclxuXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuZmFjdG9yeShcIkNvbXBhbnlTZXJ2aWNlXCIsIGZ1bmN0aW9uKEFwaVNlcnZpY2Upe1xyXG5cclxuICAgIHJldHVybiB7XHJcblxyXG4gICAgICAgIGJhc2U6XCJjb21wYW55XCIsXHJcbiAgICAgICAgXHJcbiAgICAgICAgUGljazpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5yZXN0KHRoaXMuYmFzZStcIi9zdGF0c1BpY2tzXCIsIHtcclxuICAgICAgICAgICAgICAgIHN0YXRzOnttZXRob2Q6XCJHRVRcIiwgcGFyYW1zOnt9fVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfTtcclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuZmFjdG9yeShcIkF1dGhJbnRlcmNlcHRvclwiLCBmdW5jdGlvbigkcSwgJGxvY2F0aW9uKXtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVxdWVzdDogZnVuY3Rpb24oY29uZmlnKXtcclxuICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcclxuXHJcbiAgICAgICAgICAgIHZhciB1c2VyPWdldEpTT05Mb2NhbChcInVzZXJcIik7XHJcbiAgICAgICAgICAgIHZhciB1c2VyPWdldEpTT05Mb2NhbChcInVzZXJcIik7XHJcbiAgICAgICAgICAgIGlmICghY29uZmlnLmhlYWRlcnMuQXV0aG9yaXphdGlvbiAmJiB1c2VyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycy5BdXRob3JpemF0aW9uID0gdXNlci50b2tlbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXF1ZXN0RXJyb3I6IGZ1bmN0aW9uKHJlamVjdGlvbikge1xyXG4gICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlamVjdGlvbik7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNwb25zZTogZnVuY3Rpb24ocmVzcG9uc2Upe1xyXG4gICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLnN0YXR1cyA9PT0gJ0VSUk9SJykgeyAvL0ZvcmNlIGVycm9yXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UgfHwgJHEud2hlbihyZXNwb25zZSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNwb25zZUVycm9yOiBmdW5jdGlvbihyZWplY3Rpb24pe1xyXG4gICAgICAgICAgICBpZihyZWplY3Rpb24uc3RhdHVzID09PSA0MDMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlIGFjY2VzbycpO1xyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnVzZXIgPSAnJztcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdChyZWplY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XHJcbiIsImFuZ3VsYXIubW9kdWxlKCdBcHBsaWNhdGlvbicpXHJcbiAgICAuZmFjdG9yeShcIk9hdXRoU2VydmljZVwiLCBmdW5jdGlvbihBcGlTZXJ2aWNlKXtcclxuXHJcbiAgICByZXR1cm4ge1xyXG5cclxuICAgICAgICBiYXNlOlwib2F1dGhcIixcclxuICAgICAgICBsb2dpbjpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5yZXN0KHRoaXMuYmFzZSx7XHJcbiAgICAgICAgICAgICAgICBTZXNzaW9uOnttZXRob2Q6XCJQT1NUXCIsIHBhcmFtczp7fX1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICBsb2dvdXQ6ZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgcmV0dXJuIEFwaVNlcnZpY2UucmVzdCh0aGlzLmJhc2UrXCIvbG9nb3V0XCIsIHtcclxuICAgICAgICAgICAgICAgIFNlc3Npb246e21ldGhvZDpcIkdFVFwiLCBwYXJhbXM6e319XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcm9sZTpmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICByZXR1cm4gQXBpU2VydmljZS5yZXN0KHRoaXMuYmFzZStcIi9yb2xlLzpyb2xlXCIsIHtcclxuICAgICAgICAgICAgICAgICAgY2hlY2s6e21ldGhvZDpcIkdFVFwiLCBwYXJhbXM6e3JvbGU6XCJAcm9sZVwifX0sXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9O1xyXG59KTtcclxuXHJcblxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnQXBwbGljYXRpb24nKVxyXG4gICAgLmZhY3RvcnkoXCJSZXF1ZXN0U2VydmljZVwiLCBmdW5jdGlvbigpe1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICBcclxuICAgICAgICBTZXJ2ZXJOb3RGb3VuZDogQ2xvc3VyZU1lc3NhZ2UoXCJTZXJ2ZXIgTm90IEZvdW5kXCIpLFxyXG5cclxuICAgICAgICBOb1JvbGVBdXRob3JpemVkOiBDbG9zdXJlTWVzc2FnZShcIk5vIFJvbGUgQXV0aG9yaXplZFwiKSxcclxuICAgICAgICBcclxuICAgIFxyXG4gICAgfTtcclxufSk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
